<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roteiro Pr√°tico - Transforma√ß√µes e Modelagem Dimensional</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', system-ui, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 82, 204, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: fadeInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .badge {
            background: linear-gradient(135deg, #0052cc, #003d99);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0, 82, 204, 0.3);
        }

        .etl-badge {
            background: linear-gradient(135deg, #28a745, #1e7e34);
            color: white;
            padding: 6px 14px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);
        }

        .title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 12px;
            background: linear-gradient(135deg, #0052cc, #003d99);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #666;
            font-weight: 400;
            margin-bottom: 30px;
        }

        .step-container {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            border-left: 6px solid #0052cc;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(0, 82, 204, 0.1);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .step-container:hover {
            transform: translateY(-5px);
        }

        .step-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .step-number {
            background: linear-gradient(135deg, #0052cc, #003d99);
            color: white;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 18px;
            flex-shrink: 0;
            box-shadow: 0 4px 15px rgba(0, 82, 204, 0.3);
        }

        .step-title {
            color: #0052cc;
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0;
        }

        .step-description {
            color: #444;
            line-height: 1.7;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .theory-box {
            background: rgba(75, 192, 192, 0.1);
            border: 2px solid rgba(75, 192, 192, 0.3);
            border-radius: 16px;
            padding: 20px;
            margin: 20px 0;
        }

        .theory-box h4 {
            color: #4bc0c0;
            font-size: 1.2rem;
            margin-bottom: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 25px;
            border-radius: 12px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            line-height: 1.6;
            overflow-x: auto;
            margin: 20px 0;
            border-left: 4px solid #0052cc;
            position: relative;
        }

        .code-header {
            background: #2d2d2d;
            color: #ffffff;
            padding: 10px 20px;
            margin: -25px -25px 15px -25px;
            border-radius: 12px 12px 0 0;
            font-size: 12px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .copy-button {
            background: #0052cc;
            color: white;
            border: none;
            padding: 5px 12px;
            border-radius: 6px;
            font-size: 11px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .copy-button:hover {
            background: #003d99;
        }

        .output-example {
            background: rgba(76, 175, 80, 0.1);
            border: 2px solid rgba(76, 175, 80, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 13px;
        }

        .output-header {
            color: #388e3c;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .highlight-box {
            background: linear-gradient(135deg, #0052cc, #003d99);
            color: white;
            padding: 25px;
            border-radius: 16px;
            margin: 25px 0;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 25px rgba(0, 82, 204, 0.3);
        }

        .highlight-box h4 {
            font-size: 1.3rem;
            margin-bottom: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .warning-box {
            background: rgba(255, 193, 7, 0.1);
            border: 2px solid rgba(255, 193, 7, 0.3);
            border-radius: 16px;
            padding: 20px;
            margin: 20px 0;
        }

        .warning-box h4 {
            color: #f57c00;
            font-size: 1.2rem;
            margin-bottom: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-panel {
            background: rgba(33, 150, 243, 0.1);
            border: 2px solid rgba(33, 150, 243, 0.2);
            border-radius: 16px;
            padding: 20px;
            margin: 20px 0;
        }

        .info-panel h4 {
            color: #1976d2;
            font-size: 1.2rem;
            margin-bottom: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .button {
            background: linear-gradient(135deg, #0052cc, #003d99);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            font-size: 16px;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(0, 82, 204, 0.3);
            margin: 10px 10px 10px 0;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 82, 204, 0.4);
            text-decoration: none;
            color: white;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .list {
            margin: 15px 0;
            padding-left: 0;
            list-style: none;
        }

        .list li {
            color: #444;
            line-height: 1.7;
            margin-bottom: 12px;
            position: relative;
            padding-left: 25px;
        }

        .list li::before {
            content: '‚ñ∂';
            color: #0052cc;
            position: absolute;
            left: 0;
            font-size: 14px;
            top: 2px;
        }

        .explanation-box {
            background: rgba(255, 255, 255, 0.5);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #0052cc;
        }

        .explanation-box h5 {
            color: #0052cc;
            font-size: 1.1rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .explanation-box p {
            color: #555;
            line-height: 1.6;
            font-size: 0.95rem;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 25px;
                margin: 10px;
            }

            .title {
                font-size: 2rem;
            }

            .step-container {
                padding: 20px;
            }

            .code-block {
                padding: 15px;
                font-size: 12px;
            }

            .step-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .step-number {
                width: 35px;
                height: 35px;
                font-size: 16px;
            }

            .step-title {
                font-size: 1.3rem;
            }
        }

        .syntax-keyword { color: #569cd6; }
        .syntax-string { color: #ce9178; }
        .syntax-comment { color: #6a9955; }
        .syntax-number { color: #b5cea8; }
        .syntax-function { color: #dcdcaa; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="badge">üìã Roteiro Pr√°tico</div>
            <h1 class="title">Transforma√ß√µes e Modelagem Dimensional</h1>
            <p class="subtitle">Guia passo-a-passo com blocos de c√≥digo para Google Colab</p>
        </div>

        <div class="highlight-box">
            <h4>üéØ O que vamos construir</h4>
            <p>Um sistema completo de ETL e modelagem dimensional para e-commerce, simulando 10.000 transa√ß√µes reais, aplicando transforma√ß√µes de dados e criando um Data Warehouse funcional seguindo os conceitos da aula.</p>
        </div>

        <div class="info-panel">
            <h4>üìù Prepara√ß√£o Inicial</h4>
            <p>Acesse <strong>colab.research.google.com</strong> e crie um novo notebook. Renomeie para "Aula2_Transformacoes_Modelagem". Execute cada bloco de c√≥digo em sequ√™ncia, acompanhando as explica√ß√µes te√≥ricas.</p>
        </div>

        <!-- Passo 1: Configura√ß√£o Inicial -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">1</div>
                <h2 class="step-title">Configura√ß√£o e Importa√ß√µes</h2>
            </div>
            <div class="etl-badge">üîß Prepara√ß√£o do Ambiente</div>
            <p class="step-description">Antes de iniciarmos o processo ETL, precisamos preparar nosso ambiente de trabalho. Esta etapa √© fundamental para garantir que todas as ferramentas necess√°rias estejam dispon√≠veis para as transforma√ß√µes que faremos nos dados.</p>
            
            <div class="theory-box">
                <h4>üí° Conceito Te√≥rico</h4>
                <p>A prepara√ß√£o do ambiente √© uma etapa cr√≠tica em qualquer projeto de Data Science. Definimos bibliotecas, configura√ß√µes de visualiza√ß√£o e seeds para reprodutibilidade, garantindo que nossos experimentos possam ser replicados com os mesmos resultados.</p>
            </div>
            
            <div class="code-block">
                <div class="code-header">
                    <span>üì¶ Importa√ß√µes e Configura√ß√µes</span>
                    <button class="copy-button" onclick="copyCode(this)">Copiar</button>
                </div>
<pre><code><span class="syntax-comment"># -*- coding: utf-8 -*-</span>
<span class="syntax-comment">"""
# Data Science - Aula 2: Transforma√ß√µes e Modelagem Dimensional
## Exemplo Pr√°tico: E-commerce Analytics

**Objetivo:** Implementar transforma√ß√µes de dados e modelagem dimensional na pr√°tica
"""</span>

<span class="syntax-comment"># Importa√ß√£o das bibliotecas necess√°rias</span>
<span class="syntax-keyword">import</span> pandas <span class="syntax-keyword">as</span> pd
<span class="syntax-keyword">import</span> numpy <span class="syntax-keyword">as</span> np
<span class="syntax-keyword">import</span> matplotlib.pyplot <span class="syntax-keyword">as</span> plt
<span class="syntax-keyword">import</span> seaborn <span class="syntax-keyword">as</span> sns
<span class="syntax-keyword">from</span> datetime <span class="syntax-keyword">import</span> datetime, timedelta
<span class="syntax-keyword">import</span> warnings
warnings.filterwarnings(<span class="syntax-string">'ignore'</span>)

<span class="syntax-comment"># Configura√ß√£o do ambiente</span>
plt.style.use(<span class="syntax-string">'seaborn-v0_8'</span>)
sns.set_palette(<span class="syntax-string">"husl"</span>)
np.random.seed(<span class="syntax-number">42</span>)  <span class="syntax-comment"># Para reprodutibilidade</span>

<span class="syntax-function">print</span>(<span class="syntax-string">"‚úÖ Bibliotecas carregadas com sucesso!"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"üîÑ Iniciando simula√ß√£o de dados de e-commerce..."</span>)</code></pre>
            </div>

            <div class="explanation-box">
                <h5>üîç O que este c√≥digo faz:</h5>
                <p><strong>Pandas:</strong> Manipula√ß√£o de dados estruturados | <strong>NumPy:</strong> Opera√ß√µes num√©ricas | <strong>Matplotlib/Seaborn:</strong> Visualiza√ß√µes | <strong>Datetime:</strong> Manipula√ß√£o de datas | <strong>Seed(42):</strong> Garante reprodutibilidade dos dados aleat√≥rios</p>
            </div>

            <div class="output-example">
                <div class="output-header">üì§ Sa√≠da esperada:</div>
                ‚úÖ Bibliotecas carregadas com sucesso!<br>
                üîÑ Iniciando simula√ß√£o de dados de e-commerce...
            </div>
        </div>

        <!-- Passo 2: Simula√ß√£o de Dados Brutos -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">2</div>
                <h2 class="step-title">Simula√ß√£o de Dados Brutos</h2>
            </div>
            <div class="etl-badge">üì• EXTRACT - Extra√ß√£o de Dados</div>
            <p class="step-description">Esta etapa simula a <strong>extra√ß√£o (Extract)</strong> do processo ETL. Em um cen√°rio real, estar√≠amos extraindo dados de diferentes sistemas operacionais: CRM, ERP, logs de servidor, etc. Aqui, simulamos como os dados chegam de fontes heterog√™neas com formatos e estruturas diferentes.</p>
            
            <div class="theory-box">
                <h4>üìö Extra√ß√£o em Sistemas Reais</h4>
                <p>Em um ambiente corporativo real, dados v√™m de m√∫ltiplas fontes: bancos transacionais, APIs, arquivos CSV, logs de sistema, etc. Cada fonte tem sua pr√≥pria estrutura, formato de data, moeda e qualidade de dados. Nossa simula√ß√£o replica essa heterogeneidade.</p>
            </div>
            
            <div class="code-block">
                <div class="code-header">
                    <span>üè™ Dados de Vendas (Sistema Transacional)</span>
                    <button class="copy-button" onclick="copyCode(this)">Copiar</button>
                </div>
<pre><code><span class="syntax-comment"># Simulando dados brutos de vendas</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"üîÑ Gerando dados brutos de vendas..."</span>)

n_transacoes = <span class="syntax-number">10000</span>
dados_vendas_brutos = []

<span class="syntax-keyword">for</span> i <span class="syntax-keyword">in</span> <span class="syntax-function">range</span>(n_transacoes):
    transacao = {
        <span class="syntax-string">'transaction_id'</span>: <span class="syntax-string">f'TXN{i+1:06d}'</span>,
        <span class="syntax-string">'customer_id'</span>: <span class="syntax-string">f'CUST{np.random.randint(1, 2001):05d}'</span>,
        <span class="syntax-string">'product_code'</span>: <span class="syntax-string">f'PROD{np.random.randint(1, 501):04d}'</span>,
        <span class="syntax-string">'store_id'</span>: <span class="syntax-string">f'ST{np.random.randint(1, 21):03d}'</span>,
        <span class="syntax-string">'transaction_date'</span>: (datetime(<span class="syntax-number">2024</span>, <span class="syntax-number">1</span>, <span class="syntax-number">1</span>) + timedelta(days=np.random.randint(<span class="syntax-number">0</span>, <span class="syntax-number">365</span>))).strftime(<span class="syntax-string">'%Y-%m-%d %H:%M:%S'</span>),
        <span class="syntax-string">'quantity'</span>: np.random.randint(<span class="syntax-number">1</span>, <span class="syntax-number">6</span>),
        <span class="syntax-string">'unit_price'</span>: np.round(np.random.uniform(<span class="syntax-number">10.0</span>, <span class="syntax-number">500.0</span>), <span class="syntax-number">2</span>),
        <span class="syntax-string">'discount_percent'</span>: np.random.choice([<span class="syntax-number">0</span>, <span class="syntax-number">5</span>, <span class="syntax-number">10</span>, <span class="syntax-number">15</span>, <span class="syntax-number">20</span>], p=[<span class="syntax-number">0.4</span>, <span class="syntax-number">0.2</span>, <span class="syntax-number">0.2</span>, <span class="syntax-number">0.15</span>, <span class="syntax-number">0.05</span>]),
        <span class="syntax-string">'currency'</span>: np.random.choice([<span class="syntax-string">'BRL'</span>, <span class="syntax-string">'USD'</span>, <span class="syntax-string">'EUR'</span>], p=[<span class="syntax-number">0.7</span>, <span class="syntax-number">0.2</span>, <span class="syntax-number">0.1</span>]),
        <span class="syntax-string">'payment_method'</span>: np.random.choice([<span class="syntax-string">'CREDIT_CARD'</span>, <span class="syntax-string">'DEBIT_CARD'</span>, <span class="syntax-string">'PIX'</span>, <span class="syntax-string">'BOLETO'</span>], p=[<span class="syntax-number">0.4</span>, <span class="syntax-number">0.3</span>, <span class="syntax-number">0.2</span>, <span class="syntax-number">0.1</span>])
    }
    dados_vendas_brutos.append(transacao)

df_vendas_bruto = pd.DataFrame(dados_vendas_brutos)
<span class="syntax-function">print</span>(<span class="syntax-string">f"‚úÖ {len(df_vendas_bruto):,} transa√ß√µes geradas"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"üìä Primeiras 5 transa√ß√µes:"</span>)
<span class="syntax-function">print</span>(df_vendas_bruto.head())</code></pre>
            </div>

            <div class="explanation-box">
                <h5>üîç Dados de Vendas - Sistema Transacional:</h5>
                <p>Simula dados vindos de um sistema de PDV (Ponto de Venda). Note os <strong>problemas t√≠picos</strong>: m√∫ltiplas moedas, datas como string, IDs em formatos diferentes. Isso replica a realidade de sistemas legados que n√£o seguem padr√µes √∫nicos.</p>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span>üì¶ Dados de Produtos</span>
                    <button class="copy-button" onclick="copyCode(this)">Copiar</button>
                </div>
<pre><code><span class="syntax-comment"># Simulando dados de produtos</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\nüì¶ Gerando dados brutos de produtos..."</span>)

categorias = [<span class="syntax-string">'Eletr√¥nicos'</span>, <span class="syntax-string">'Roupas'</span>, <span class="syntax-string">'Casa & Jardim'</span>, <span class="syntax-string">'Livros'</span>, <span class="syntax-string">'Esportes'</span>, <span class="syntax-string">'Beleza'</span>]
subcategorias = {
    <span class="syntax-string">'Eletr√¥nicos'</span>: [<span class="syntax-string">'Smartphones'</span>, <span class="syntax-string">'Laptops'</span>, <span class="syntax-string">'Tablets'</span>, <span class="syntax-string">'Acess√≥rios'</span>],
    <span class="syntax-string">'Roupas'</span>: [<span class="syntax-string">'Masculino'</span>, <span class="syntax-string">'Feminino'</span>, <span class="syntax-string">'Infantil'</span>, <span class="syntax-string">'Cal√ßados'</span>],
    <span class="syntax-string">'Casa & Jardim'</span>: [<span class="syntax-string">'M√≥veis'</span>, <span class="syntax-string">'Decora√ß√£o'</span>, <span class="syntax-string">'Jardim'</span>, <span class="syntax-string">'Cozinha'</span>],
    <span class="syntax-string">'Livros'</span>: [<span class="syntax-string">'Fic√ß√£o'</span>, <span class="syntax-string">'T√©cnicos'</span>, <span class="syntax-string">'Infantis'</span>, <span class="syntax-string">'Biografias'</span>],
    <span class="syntax-string">'Esportes'</span>: [<span class="syntax-string">'Fitness'</span>, <span class="syntax-string">'Futebol'</span>, <span class="syntax-string">'Basquete'</span>, <span class="syntax-string">'Nata√ß√£o'</span>],
    <span class="syntax-string">'Beleza'</span>: [<span class="syntax-string">'Skincare'</span>, <span class="syntax-string">'Maquiagem'</span>, <span class="syntax-string">'Perfumes'</span>, <span class="syntax-string">'Cabelo'</span>]
}

dados_produtos_brutos = []
<span class="syntax-keyword">for</span> i <span class="syntax-keyword">in</span> <span class="syntax-function">range</span>(<span class="syntax-number">1</span>, <span class="syntax-number">501</span>):
    categoria = np.random.choice(categorias)
    produto = {
        <span class="syntax-string">'product_code'</span>: <span class="syntax-string">f'PROD{i:04d}'</span>,
        <span class="syntax-string">'product_name'</span>: <span class="syntax-string">f'Produto {i}'</span>,
        <span class="syntax-string">'category'</span>: categoria,
        <span class="syntax-string">'subcategory'</span>: np.random.choice(subcategorias[categoria]),
        <span class="syntax-string">'brand'</span>: <span class="syntax-string">f'Marca {np.random.randint(1, 21)}'</span>,
        <span class="syntax-string">'supplier'</span>: <span class="syntax-string">f'Fornecedor {np.random.randint(1, 51)}'</span>,
        <span class="syntax-string">'cost_price'</span>: np.round(np.random.uniform(<span class="syntax-number">5.0</span>, <span class="syntax-number">300.0</span>), <span class="syntax-number">2</span>),
        <span class="syntax-string">'status'</span>: np.random.choice([<span class="syntax-string">'ACTIVE'</span>, <span class="syntax-string">'INACTIVE'</span>], p=[<span class="syntax-number">0.9</span>, <span class="syntax-number">0.1</span>])
    }
    dados_produtos_brutos.append(produto)

df_produtos_bruto = pd.DataFrame(dados_produtos_brutos)
<span class="syntax-function">print</span>(<span class="syntax-string">f"‚úÖ {len(df_produtos_bruto):,} produtos gerados"</span>)
<span class="syntax-function">print</span>(df_produtos_bruto.groupby(<span class="syntax-string">'category'</span>).size())</code></pre>
            </div>

            <div class="explanation-box">
                <h5>üîç Dados de Produtos - Sistema de Cat√°logo:</h5>
                <p>Simula dados vindos de um sistema ERP ou de gest√£o de produtos. Inclui hierarquias (categoria > subcategoria), fornecedores e status que precisar√£o ser tratados na fase de Transform.</p>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span>üë• Dados de Clientes e üè™ Lojas</span>
                    <button class="copy-button" onclick="copyCode(this)">Copiar</button>
                </div>
<pre><code><span class="syntax-comment"># Dados de clientes</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\nüë• Gerando dados brutos de clientes..."</span>)

estados_br = [<span class="syntax-string">'SP'</span>, <span class="syntax-string">'RJ'</span>, <span class="syntax-string">'MG'</span>, <span class="syntax-string">'RS'</span>, <span class="syntax-string">'PR'</span>, <span class="syntax-string">'SC'</span>, <span class="syntax-string">'BA'</span>, <span class="syntax-string">'GO'</span>, <span class="syntax-string">'PE'</span>, <span class="syntax-string">'CE'</span>]
dados_clientes_brutos = []

<span class="syntax-keyword">for</span> i <span class="syntax-keyword">in</span> <span class="syntax-function">range</span>(<span class="syntax-number">1</span>, <span class="syntax-number">2001</span>):
    cliente = {
        <span class="syntax-string">'customer_id'</span>: <span class="syntax-string">f'CUST{i:05d}'</span>,
        <span class="syntax-string">'customer_name'</span>: <span class="syntax-string">f'Cliente {i}'</span>,
        <span class="syntax-string">'email'</span>: <span class="syntax-string">f'cliente{i}@email.com'</span>,
        <span class="syntax-string">'birth_date'</span>: (datetime(<span class="syntax-number">2024</span>, <span class="syntax-number">1</span>, <span class="syntax-number">1</span>) - timedelta(days=np.random.randint(<span class="syntax-number">6570</span>, <span class="syntax-number">25550</span>))).strftime(<span class="syntax-string">'%Y-%m-%d'</span>),
        <span class="syntax-string">'gender'</span>: np.random.choice([<span class="syntax-string">'M'</span>, <span class="syntax-string">'F'</span>, <span class="syntax-string">'O'</span>], p=[<span class="syntax-number">0.45</span>, <span class="syntax-number">0.45</span>, <span class="syntax-number">0.1</span>]),
        <span class="syntax-string">'state'</span>: np.random.choice(estados_br),
        <span class="syntax-string">'city'</span>: <span class="syntax-string">f'Cidade {np.random.randint(1, 101)}'</span>,
        <span class="syntax-string">'registration_date'</span>: (datetime(<span class="syntax-number">2023</span>, <span class="syntax-number">1</span>, <span class="syntax-number">1</span>) + timedelta(days=np.random.randint(<span class="syntax-number">0</span>, <span class="syntax-number">365</span>))).strftime(<span class="syntax-string">'%Y-%m-%d'</span>),
        <span class="syntax-string">'customer_segment'</span>: np.random.choice([<span class="syntax-string">'Bronze'</span>, <span class="syntax-string">'Silver'</span>, <span class="syntax-string">'Gold'</span>, <span class="syntax-string">'Platinum'</span>], p=[<span class="syntax-number">0.4</span>, <span class="syntax-number">0.3</span>, <span class="syntax-number">0.2</span>, <span class="syntax-number">0.1</span>])
    }
    dados_clientes_brutos.append(cliente)

df_clientes_bruto = pd.DataFrame(dados_clientes_brutos)

<span class="syntax-comment"># Dados de lojas</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\nüè™ Gerando dados brutos de lojas..."</span>)

dados_lojas_brutos = []
<span class="syntax-keyword">for</span> i <span class="syntax-keyword">in</span> <span class="syntax-function">range</span>(<span class="syntax-number">1</span>, <span class="syntax-number">21</span>):
    loja = {
        <span class="syntax-string">'store_id'</span>: <span class="syntax-string">f'ST{i:03d}'</span>,
        <span class="syntax-string">'store_name'</span>: <span class="syntax-string">f'Loja {i}'</span>,
        <span class="syntax-string">'store_type'</span>: np.random.choice([<span class="syntax-string">'Physical'</span>, <span class="syntax-string">'Online'</span>], p=[<span class="syntax-number">0.7</span>, <span class="syntax-number">0.3</span>]),
        <span class="syntax-string">'state'</span>: np.random.choice(estados_br),
        <span class="syntax-string">'region'</span>: np.random.choice([<span class="syntax-string">'Norte'</span>, <span class="syntax-string">'Nordeste'</span>, <span class="syntax-string">'Centro-Oeste'</span>, <span class="syntax-string">'Sudeste'</span>, <span class="syntax-string">'Sul'</span>]),
        <span class="syntax-string">'manager'</span>: <span class="syntax-string">f'Gerente {i}'</span>,
        <span class="syntax-string">'opening_date'</span>: (datetime(<span class="syntax-number">2020</span>, <span class="syntax-number">1</span>, <span class="syntax-number">1</span>) + timedelta(days=np.random.randint(<span class="syntax-number">0</span>, <span class="syntax-number">1460</span>))).strftime(<span class="syntax-string">'%Y-%m-%d'</span>)
    }
    dados_lojas_brutos.append(loja)

df_lojas_bruto = pd.DataFrame(dados_lojas_brutos)

<span class="syntax-comment"># Resumo dos dados gerados</span>
<span class="syntax-function">print</span>(<span class="syntax-string">f"\n‚úÖ DADOS BRUTOS GERADOS:"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"üìä Vendas: {len(df_vendas_bruto):,} transa√ß√µes"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"üì¶ Produtos: {len(df_produtos_bruto):,} itens"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"üë• Clientes: {len(df_clientes_bruto):,} registros"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"üè™ Lojas: {len(df_lojas_bruto):,} unidades"</span>)</code></pre>
            </div>

            <div class="explanation-box">
                <h5>üîç Dados de Clientes e Lojas:</h5>
                <p><strong>Clientes (CRM):</strong> Dados demogr√°ficos com datas de nascimento para calcular idade | <strong>Lojas (Sistema Corporativo):</strong> Informa√ß√µes geogr√°ficas para an√°lise regional. Note como cada fonte tem suas pr√≥prias conven√ß√µes de ID.</p>
            </div>

            <div class="output-example">
                <div class="output-header">üì§ Sa√≠da esperada:</div>
                ‚úÖ DADOS BRUTOS GERADOS:<br>
                üìä Vendas: 10,000 transa√ß√µes<br>
                üì¶ Produtos: 500 itens<br>
                üë• Clientes: 2,000 registros<br>
                üè™ Lojas: 20 unidades
            </div>
        </div>

        <!-- Passo 3: Transforma√ß√µes ETL -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">3</div>
                <h2 class="step-title">Transforma√ß√µes ETL</h2>
            </div>
            <div class="etl-badge">üîÑ TRANSFORM - Transforma√ß√£o de Dados</div>
            <p class="step-description">Esta √© o cora√ß√£o do processo ETL - a etapa de <strong>Transform</strong>. Aqui aplicamos todas as transforma√ß√µes mencionadas na aula: limpeza, padroniza√ß√£o, deriva√ß√µes e agrega√ß√µes. √â onde os dados brutos se tornam informa√ß√£o √∫til para an√°lise.</p>
            
            <div class="theory-box">
                <h4>üîÑ As 4 Categorias de Transforma√ß√£o</h4>
                <p><strong>1. Limpeza:</strong> Remove inconsist√™ncias e dados inv√°lidos | <strong>2. Padroniza√ß√£o:</strong> Uniformiza formatos e unidades | <strong>3. Deriva√ß√µes:</strong> Cria novos campos calculados | <strong>4. Agrega√ß√µes:</strong> Sumariza dados para an√°lise</p>
            </div>
            
            <div class="code-block">
                <div class="code-header">
                    <span>üßπ Limpeza e Padroniza√ß√£o</span>
                    <button class="copy-button" onclick="copyCode(this)">Copiar</button>
                </div>
<pre><code><span class="syntax-function">print</span>(<span class="syntax-string">"\n" + "="*60</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"üîÑ INICIANDO TRANSFORMA√á√ïES DE DADOS"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"="*60</span>)

<span class="syntax-comment"># 1. LIMPEZA DE DADOS</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\nüßπ LIMPEZA DE DADOS"</span>)

<span class="syntax-comment"># Remover produtos inativos</span>
df_produtos_limpo = df_produtos_bruto[df_produtos_bruto[<span class="syntax-string">'status'</span>] == <span class="syntax-string">'ACTIVE'</span>].copy()
<span class="syntax-function">print</span>(<span class="syntax-string">f"   ‚úÖ Removidos {len(df_produtos_bruto) - len(df_produtos_limpo)} produtos inativos"</span>)

<span class="syntax-comment"># Filtrar transa√ß√µes v√°lidas</span>
df_vendas_limpo = df_vendas_bruto[df_vendas_bruto[<span class="syntax-string">'quantity'</span>] > <span class="syntax-number">0</span>].copy()
<span class="syntax-function">print</span>(<span class="syntax-string">f"   ‚úÖ Mantidas {len(df_vendas_limpo):,} transa√ß√µes v√°lidas"</span>)

<span class="syntax-comment"># 2. PADRONIZA√á√ÉO</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\nüí± PADRONIZA√á√ÉO"</span>)

<span class="syntax-comment"># Converter moedas para BRL</span>
taxas_cambio = {<span class="syntax-string">'BRL'</span>: <span class="syntax-number">1.0</span>, <span class="syntax-string">'USD'</span>: <span class="syntax-number">5.2</span>, <span class="syntax-string">'EUR'</span>: <span class="syntax-number">5.8</span>}

df_vendas_limpo[<span class="syntax-string">'unit_price_brl'</span>] = df_vendas_limpo.apply(
    <span class="syntax-keyword">lambda</span> row: row[<span class="syntax-string">'unit_price'</span>] * taxas_cambio[row[<span class="syntax-string">'currency'</span>]], axis=<span class="syntax-number">1</span>
)

<span class="syntax-comment"># Padronizar datas</span>
df_vendas_limpo[<span class="syntax-string">'transaction_date'</span>] = pd.to_datetime(df_vendas_limpo[<span class="syntax-string">'transaction_date'</span>])
df_clientes_limpo = df_clientes_bruto.copy()
df_clientes_limpo[<span class="syntax-string">'birth_date'</span>] = pd.to_datetime(df_clientes_limpo[<span class="syntax-string">'birth_date'</span>])
df_clientes_limpo[<span class="syntax-string">'registration_date'</span>] = pd.to_datetime(df_clientes_limpo[<span class="syntax-string">'registration_date'</span>])

<span class="syntax-function">print</span>(<span class="syntax-string">"   ‚úÖ Moedas convertidas para BRL"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"   ‚úÖ Datas padronizadas"</span>)</code></pre>
            </div>

            <div class="explanation-box">
                <h5>üîç Limpeza e Padroniza√ß√£o Aplicadas:</h5>
                <p><strong>Limpeza:</strong> Removemos produtos inativos (n√£o devem aparecer em an√°lises) e transa√ß√µes com quantidade zero | <strong>Padroniza√ß√£o:</strong> Convertemos m√∫ltiplas moedas para BRL usando taxas fixas e transformamos strings de data em objetos datetime do Pandas</p>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span>üî¢ Deriva√ß√µes e C√°lculos</span>
                    <button class="copy-button" onclick="copyCode(this)">Copiar</button>
                </div>
<pre><code><span class="syntax-comment"># 3. DERIVA√á√ïES</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\nüî¢ CRIA√á√ÉO DE CAMPOS DERIVADOS"</span>)

<span class="syntax-comment"># Campos calculados nas vendas</span>
df_vendas_limpo[<span class="syntax-string">'discount_amount'</span>] = (df_vendas_limpo[<span class="syntax-string">'unit_price_brl'</span>] * 
                                        df_vendas_limpo[<span class="syntax-string">'discount_percent'</span>] / <span class="syntax-number">100</span>)
df_vendas_limpo[<span class="syntax-string">'final_unit_price'</span>] = df_vendas_limpo[<span class="syntax-string">'unit_price_brl'</span>] - df_vendas_limpo[<span class="syntax-string">'discount_amount'</span>]
df_vendas_limpo[<span class="syntax-string">'total_amount'</span>] = df_vendas_limpo[<span class="syntax-string">'final_unit_price'</span>] * df_vendas_limpo[<span class="syntax-string">'quantity'</span>]

<span class="syntax-comment"># Derivar idade dos clientes</span>
df_clientes_limpo[<span class="syntax-string">'age'</span>] = ((datetime.now() - df_clientes_limpo[<span class="syntax-string">'birth_date'</span>]).dt.days / <span class="syntax-number">365.25</span>).astype(int)

<span class="syntax-comment"># Criar faixas et√°rias</span>
<span class="syntax-keyword">def</span> <span class="syntax-function">categorizar_idade</span>(idade):
    <span class="syntax-keyword">if</span> idade < <span class="syntax-number">25</span>:
        <span class="syntax-keyword">return</span> <span class="syntax-string">'18-24'</span>
    <span class="syntax-keyword">elif</span> idade < <span class="syntax-number">35</span>:
        <span class="syntax-keyword">return</span> <span class="syntax-string">'25-34'</span>
    <span class="syntax-keyword">elif</span> idade < <span class="syntax-number">45</span>:
        <span class="syntax-keyword">return</span> <span class="syntax-string">'35-44'</span>
    <span class="syntax-keyword">elif</span> idade < <span class="syntax-number">55</span>:
        <span class="syntax-keyword">return</span> <span class="syntax-string">'45-54'</span>
    <span class="syntax-keyword">else</span>:
        <span class="syntax-keyword">return</span> <span class="syntax-string">'55+'</span>

df_clientes_limpo[<span class="syntax-string">'age_group'</span>] = df_clientes_limpo[<span class="syntax-string">'age'</span>].apply(categorizar_idade)

<span class="syntax-function">print</span>(<span class="syntax-string">"   ‚úÖ Valores calculados: desconto, pre√ßo final, total"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"   ‚úÖ Idade e faixas et√°rias derivadas"</span>)

<span class="syntax-comment"># Mostrar exemplo das transforma√ß√µes</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\nüìä Exemplo de dados transformados:"</span>)
<span class="syntax-function">print</span>(df_vendas_limpo[[<span class="syntax-string">'transaction_id'</span>, <span class="syntax-string">'unit_price_brl'</span>, <span class="syntax-string">'discount_amount'</span>, <span class="syntax-string">'total_amount'</span>]].head())</code></pre>
            </div>

            <div class="explanation-box">
                <h5>üîç Deriva√ß√µes Aplicadas:</h5>
                <p><strong>Campos Financeiros:</strong> Calculamos valor do desconto, pre√ßo final e total da venda | <strong>Demografia:</strong> Derivamos idade a partir da data de nascimento | <strong>Segmenta√ß√£o:</strong> Criamos faixas et√°rias para an√°lise comportamental. Essas deriva√ß√µes evitam c√°lculos repetitivos em consultas futuras.</p>
            </div>
        </div>

        <!-- Passo 4: Cria√ß√£o das Dimens√µes -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">4</div>
                <h2 class="step-title">Cria√ß√£o das Tabelas de Dimens√£o</h2>
            </div>
            <div class="etl-badge">üèóÔ∏è MODELAGEM DIMENSIONAL - Dimens√µes</div>
            <p class="step-description">Agora entramos na <strong>modelagem dimensional</strong>. Criamos as tabelas de dimens√£o que fornecem contexto aos dados quantitativos. Como visto na aula, dimens√µes respondem √†s perguntas: Quem? O qu√™? Onde? Quando? Elas s√£o desnormalizadas para otimizar consultas anal√≠ticas.</p>
            
            <div class="theory-box">
                <h4>üìä Caracter√≠sticas das Dimens√µes</h4>
                <p><strong>Chave Prim√°ria Simples:</strong> ID √∫nico para cada registro | <strong>Atributos Descritivos:</strong> Textos e categoriza√ß√µes | <strong>Desnormalizadas:</strong> Contrariando 3FN para otimizar consultas | <strong>Relativamente Est√°ticas:</strong> Mudam menos frequentemente que fatos</p>
            </div>
            
            <div class="code-block">
                <div class="code-header">
                    <span>üìÖ Dimens√£o Tempo</span>
                    <button class="copy-button" onclick="copyCode(this)">Copiar</button>
                </div>
<pre><code><span class="syntax-function">print</span>(<span class="syntax-string">"\n" + "="*60</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"üìã CRIANDO TABELAS DE DIMENS√ÉO"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"="*60</span>)

<span class="syntax-comment"># DIMENS√ÉO TEMPO</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\nüìÖ Criando Dimens√£o Tempo..."</span>)

<span class="syntax-comment"># Gerar todas as datas do per√≠odo</span>
start_date = df_vendas_limpo[<span class="syntax-string">'transaction_date'</span>].min().date()
end_date = df_vendas_limpo[<span class="syntax-string">'transaction_date'</span>].max().date()
date_range = pd.date_range(start=start_date, end=end_date, freq=<span class="syntax-string">'D'</span>)

dim_tempo = pd.DataFrame({
    <span class="syntax-string">'date_key'</span>: <span class="syntax-function">range</span>(<span class="syntax-function">len</span>(date_range)),
    <span class="syntax-string">'date'</span>: date_range,
    <span class="syntax-string">'year'</span>: date_range.year,
    <span class="syntax-string">'quarter'</span>: date_range.quarter,
    <span class="syntax-string">'month'</span>: date_range.month,
    <span class="syntax-string">'month_name'</span>: date_range.strftime(<span class="syntax-string">'%B'</span>),
    <span class="syntax-string">'day'</span>: date_range.day,
    <span class="syntax-string">'day_of_week'</span>: date_range.dayofweek + <span class="syntax-number">1</span>,
    <span class="syntax-string">'day_name'</span>: date_range.strftime(<span class="syntax-string">'%A'</span>),
    <span class="syntax-string">'week_of_year'</span>: date_range.isocalendar().week,
    <span class="syntax-string">'is_weekend'</span>: (date_range.dayofweek >= <span class="syntax-number">5</span>).astype(int),
    <span class="syntax-string">'is_holiday'</span>: <span class="syntax-number">0</span>  <span class="syntax-comment"># Simplificado</span>
})

<span class="syntax-comment"># Marcar alguns feriados brasileiros</span>
feriados = [<span class="syntax-string">'2024-01-01'</span>, <span class="syntax-string">'2024-04-21'</span>, <span class="syntax-string">'2024-09-07'</span>, <span class="syntax-string">'2024-10-12'</span>, <span class="syntax-string">'2024-11-15'</span>, <span class="syntax-string">'2024-12-25'</span>]
dim_tempo.loc[dim_tempo[<span class="syntax-string">'date'</span>].isin(pd.to_datetime(feriados)), <span class="syntax-string">'is_holiday'</span>] = <span class="syntax-number">1</span>

<span class="syntax-function">print</span>(<span class="syntax-string">f"   ‚úÖ Dimens√£o Tempo criada: {len(dim_tempo)} registros"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"   üìã Estrutura da dimens√£o tempo:"</span>)
<span class="syntax-function">print</span>(dim_tempo.head())</code></pre>
            </div>

            <div class="explanation-box">
                <h5>üîç Dimens√£o Tempo - A Mais Importante:</h5>
                <p>A dimens√£o tempo √© fundamental em Data Warehouses. Pr√©-calculamos <strong>todas as hierarquias temporais</strong>: ano, trimestre, m√™s, semana, dia. Inclu√≠mos flags como fim de semana e feriados. Isso permite an√°lises temporais complexas com consultas simples (ex: "vendas em feriados do Q4").</p>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span>üë•üì¶üè™ Dimens√µes Cliente, Produto e Loja</span>
                    <button class="copy-button" onclick="copyCode(this)">Copiar</button>
                </div>
<pre><code><span class="syntax-comment"># DIMENS√ÉO CLIENTE</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\nüë• Criando Dimens√£o Cliente..."</span>)

dim_cliente = df_clientes_limpo.copy()
dim_cliente[<span class="syntax-string">'customer_key'</span>] = <span class="syntax-function">range</span>(<span class="syntax-function">len</span>(dim_cliente))

dim_cliente = dim_cliente[[<span class="syntax-string">'customer_key'</span>, <span class="syntax-string">'customer_id'</span>, <span class="syntax-string">'customer_name'</span>, <span class="syntax-string">'email'</span>, 
                          <span class="syntax-string">'gender'</span>, <span class="syntax-string">'age'</span>, <span class="syntax-string">'age_group'</span>, <span class="syntax-string">'state'</span>, <span class="syntax-string">'city'</span>, 
                          <span class="syntax-string">'customer_segment'</span>, <span class="syntax-string">'registration_date'</span>]]

<span class="syntax-function">print</span>(<span class="syntax-string">f"   ‚úÖ Dimens√£o Cliente criada: {len(dim_cliente)} registros"</span>)

<span class="syntax-comment"># DIMENS√ÉO PRODUTO</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\nüì¶ Criando Dimens√£o Produto..."</span>)

<span class="syntax-comment"># Calcular estat√≠sticas por produto</span>
produto_stats = df_vendas_limpo.groupby(<span class="syntax-string">'product_code'</span>).agg({
    <span class="syntax-string">'quantity'</span>: [<span class="syntax-string">'sum'</span>, <span class="syntax-string">'mean'</span>, <span class="syntax-string">'count'</span>],
    <span class="syntax-string">'total_amount'</span>: [<span class="syntax-string">'sum'</span>, <span class="syntax-string">'mean'</span>],
    <span class="syntax-string">'customer_id'</span>: <span class="syntax-string">'nunique'</span>
}).round(<span class="syntax-number">2</span>)

produto_stats.columns = [<span class="syntax-string">'qty_total'</span>, <span class="syntax-string">'qty_media'</span>, <span class="syntax-string">'num_transacoes'</span>, <span class="syntax-string">'revenue_total'</span>, <span class="syntax-string">'revenue_media'</span>, <span class="syntax-string">'clientes_unicos'</span>]
produto_stats = produto_stats.reset_index()

dim_produto = df_produtos_limpo.copy()
dim_produto[<span class="syntax-string">'product_key'</span>] = <span class="syntax-function">range</span>(<span class="syntax-function">len</span>(dim_produto))

<span class="syntax-comment"># Merge com estat√≠sticas</span>
dim_produto = dim_produto.merge(produto_stats, on=<span class="syntax-string">'product_code'</span>, how=<span class="syntax-string">'left'</span>)
dim_produto = dim_produto.fillna(<span class="syntax-number">0</span>)

<span class="syntax-function">print</span>(<span class="syntax-string">f"   ‚úÖ Dimens√£o Produto criada: {len(dim_produto)} registros"</span>)

<span class="syntax-comment"># DIMENS√ÉO LOJA</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\nüè™ Criando Dimens√£o Loja..."</span>)

dim_loja = df_lojas_bruto.copy()
dim_loja[<span class="syntax-string">'store_key'</span>] = <span class="syntax-function">range</span>(<span class="syntax-function">len</span>(dim_loja))
dim_loja[<span class="syntax-string">'opening_date'</span>] = pd.to_datetime(dim_loja[<span class="syntax-string">'opening_date'</span>])

<span class="syntax-function">print</span>(<span class="syntax-string">f"   ‚úÖ Dimens√£o Loja criada: {len(dim_loja)} registros"</span>)

<span class="syntax-comment"># Resumo das dimens√µes</span>
<span class="syntax-function">print</span>(<span class="syntax-string">f"\nüìä RESUMO DAS DIMENS√ïES:"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"üìÖ Tempo:    {len(dim_tempo):,} registros"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"üë• Cliente:  {len(dim_cliente):,} registros"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"üì¶ Produto:  {len(dim_produto):,} registros"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"üè™ Loja:     {len(dim_loja):,} registros"</span>)</code></pre>
            </div>

            <div class="explanation-box">
                <h5>üîç Dimens√µes Criadas:</h5>
                <p><strong>Cliente:</strong> Inclui dados demogr√°ficos e faixas et√°rias derivadas | <strong>Produto:</strong> Hierarquia categoria/subcategoria + estat√≠sticas agregadas de vendas | <strong>Loja:</strong> Informa√ß√µes geogr√°ficas para an√°lise regional. Cada dimens√£o tem sua chave surrogate (customer_key, product_key, etc.) independente dos IDs originais.</p>
            </div>
        </div>

        <!-- Passo 5: Cria√ß√£o da Tabela Fato -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">5</div>
                <h2 class="step-title">Cria√ß√£o da Tabela Fato</h2>
            </div>
            <div class="etl-badge">üìä MODELAGEM DIMENSIONAL - Fatos</div>
            <p class="step-description">Agora criamos a <strong>tabela fato</strong> - o centro do nosso Star Schema. Como visto na aula, a tabela fato cont√©m as medidas num√©ricas (m√©tricas) e chaves estrangeiras para as dimens√µes. O gr√£o da nossa tabela fato √© "uma linha por item vendido".</p>
            
            <div class="theory-box">
                <h4>üìà Caracter√≠sticas da Tabela Fato</h4>
                <p><strong>Gr√£o Bem Definido:</strong> Uma linha por item vendido | <strong>Chaves Estrangeiras:</strong> Conectam √†s dimens√µes | <strong>Medidas Num√©ricas:</strong> Valores que podem ser agregados | <strong>Otimizada para Consultas:</strong> Muitas linhas, poucas colunas</p>
            </div>
            
            <div class="code-block">
                <div class="code-header">
                    <span>üíº Tabela Fato Vendas</span>
                    <button class="copy-button" onclick="copyCode(this)">Copiar</button>
                </div>
<pre><code><span class="syntax-function">print</span>(<span class="syntax-string">"\n" + "="*60</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"üìä CRIANDO TABELA FATO"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"="*60</span>)

<span class="syntax-function">print</span>(<span class="syntax-string">"\nüíº Criando Fato Vendas..."</span>)

<span class="syntax-comment"># Come√ßar com os dados de vendas limpos</span>
fato_vendas = df_vendas_limpo.copy()

<span class="syntax-comment"># Adicionar chaves das dimens√µes atrav√©s de JOINs</span>

<span class="syntax-comment"># 1. Chave da dimens√£o tempo</span>
fato_vendas[<span class="syntax-string">'date_only'</span>] = fato_vendas[<span class="syntax-string">'transaction_date'</span>].dt.date
fato_vendas[<span class="syntax-string">'date_only'</span>] = pd.to_datetime(fato_vendas[<span class="syntax-string">'date_only'</span>])

fato_vendas = fato_vendas.merge(
    dim_tempo[[<span class="syntax-string">'date_key'</span>, <span class="syntax-string">'date'</span>]], 
    left_on=<span class="syntax-string">'date_only'</span>,
    right_on=<span class="syntax-string">'date'</span>,
    how=<span class="syntax-string">'left'</span>
)

<span class="syntax-comment"># Remover colunas tempor√°rias</span>
fato_vendas = fato_vendas.drop([<span class="syntax-string">'date_only'</span>, <span class="syntax-string">'date'</span>], axis=<span class="syntax-number">1</span>)

<span class="syntax-comment"># 2. Chave da dimens√£o cliente</span>
fato_vendas = fato_vendas.merge(
    dim_cliente[[<span class="syntax-string">'customer_key'</span>, <span class="syntax-string">'customer_id'</span>]], 
    on=<span class="syntax-string">'customer_id'</span>, 
    how=<span class="syntax-string">'left'</span>
)

<span class="syntax-comment"># 3. Chave da dimens√£o produto</span>
fato_vendas = fato_vendas.merge(
    dim_produto[[<span class="syntax-string">'product_key'</span>, <span class="syntax-string">'product_code'</span>]], 
    on=<span class="syntax-string">'product_code'</span>, 
    how=<span class="syntax-string">'left'</span>
)

<span class="syntax-comment"># 4. Chave da dimens√£o loja</span>
fato_vendas = fato_vendas.merge(
    dim_loja[[<span class="syntax-string">'store_key'</span>, <span class="syntax-string">'store_id'</span>]], 
    on=<span class="syntax-string">'store_id'</span>, 
    how=<span class="syntax-string">'left'</span>
)

<span class="syntax-comment"># Criar a tabela fato final com apenas as m√©tricas e chaves</span>
fato_vendas_final = fato_vendas[[
    <span class="syntax-string">'transaction_id'</span>,
    <span class="syntax-string">'date_key'</span>,
    <span class="syntax-string">'customer_key'</span>, 
    <span class="syntax-string">'product_key'</span>,
    <span class="syntax-string">'store_key'</span>,
    <span class="syntax-string">'quantity'</span>,
    <span class="syntax-string">'unit_price_brl'</span>,
    <span class="syntax-string">'discount_percent'</span>,
    <span class="syntax-string">'discount_amount'</span>,
    <span class="syntax-string">'final_unit_price'</span>,
    <span class="syntax-string">'total_amount'</span>,
    <span class="syntax-string">'currency'</span>,
    <span class="syntax-string">'payment_method'</span>
]].copy()

<span class="syntax-function">print</span>(<span class="syntax-string">f"   ‚úÖ Fato Vendas criada: {len(fato_vendas_final):,} registros"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"   üìã Gr√£o: Uma linha por item vendido (transaction_id)"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"   üîë Chaves: {len([col for col in fato_vendas_final.columns if 'key' in col])} dimens√µes conectadas"</span>)

<span class="syntax-comment"># Verificar integridade referencial</span>
<span class="syntax-function">print</span>(<span class="syntax-string">f"\nüîç Verificando Integridade Referencial..."</span>)

keys_perdidas = <span class="syntax-number">0</span>
<span class="syntax-keyword">for</span> dim_name, key_col <span class="syntax-keyword">in</span> [(<span class="syntax-string">'Tempo'</span>, <span class="syntax-string">'date_key'</span>), (<span class="syntax-string">'Cliente'</span>, <span class="syntax-string">'customer_key'</span>), 
                         (<span class="syntax-string">'Produto'</span>, <span class="syntax-string">'product_key'</span>), (<span class="syntax-string">'Loja'</span>, <span class="syntax-string">'store_key'</span>)]:
    missing = fato_vendas_final[key_col].isnull().<span class="syntax-function">sum</span>()
    <span class="syntax-keyword">if</span> missing > <span class="syntax-number">0</span>:
        <span class="syntax-function">print</span>(<span class="syntax-string">f"   ‚ö†Ô∏è  {dim_name}: {missing} chaves ausentes"</span>)
        keys_perdidas += missing
    <span class="syntax-keyword">else</span>:
        <span class="syntax-function">print</span>(<span class="syntax-string">f"   ‚úÖ {dim_name}: Integridade OK"</span>)

<span class="syntax-keyword">if</span> keys_perdidas == <span class="syntax-number">0</span>:
    <span class="syntax-function">print</span>(<span class="syntax-string">f"\nüéâ Schema dimensional √≠ntegro! Todas as chaves est√£o conectadas."</span>)
<span class="syntax-keyword">else</span>:
    <span class="syntax-function">print</span>(<span class="syntax-string">f"\n‚ö†Ô∏è  Encontradas {keys_perdidas} inconsist√™ncias que precisam ser tratadas."</span>)

<span class="syntax-comment"># Estat√≠sticas finais</span>
<span class="syntax-function">print</span>(<span class="syntax-string">f"\nüìä ESTAT√çSTICAS DO MODELO DIMENSIONAL"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"-" * 45</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"üìÖ Dimens√£o Tempo:    {len(dim_tempo):,} registros"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"üë• Dimens√£o Cliente:  {len(dim_cliente):,} registros"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"üì¶ Dimens√£o Produto:  {len(dim_produto):,} registros"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"üè™ Dimens√£o Loja:     {len(dim_loja):,} registros"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"üíº Fato Vendas:       {len(fato_vendas_final):,} registros"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"üí∞ Revenue Total:     R$ {fato_vendas_final['total_amount'].sum():,.2f}"</span>)

<span class="syntax-function">print</span>(<span class="syntax-string">f"\nüìä Exemplo da tabela fato criada:"</span>)
<span class="syntax-function">print</span>(fato_vendas_final.head())</code></pre>
            </div>

            <div class="explanation-box">
                <h5>üîç Constru√ß√£o da Tabela Fato:</h5>
                <p><strong>JOINs com Dimens√µes:</strong> Conectamos cada transa√ß√£o √†s suas dimens√µes atrav√©s de chaves | <strong>Integridade Referencial:</strong> Verificamos se todas as chaves est√£o conectadas | <strong>Star Schema:</strong> Temos o centro (fato) conectado diretamente a todas as pontas (dimens√µes). Resultado: 10.000 fatos conectados a ~2.800 registros dimensionais.</p>
            </div>
        </div>

        <!-- Passo 6: Consultas Anal√≠ticas -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">6</div>
                <h2 class="step-title">Consultas Anal√≠ticas</h2>
            </div>
            <div class="etl-badge">üìà BUSINESS INTELLIGENCE - Consultas</div>
            <p class="step-description">Agora vem o grande benef√≠cio da modelagem dimensional: <strong>consultas complexas se tornam simples</strong>. Como mencionado na aula, perguntas como "Vendas por categoria no √∫ltimo trimestre" tornam-se JOINs otimizados, n√£o agrega√ß√µes complexas em dados normalizados.</p>
            
            <div class="theory-box">
                <h4>‚ö° Poder da Modelagem Dimensional</h4>
                <p><strong>JOINs Simples:</strong> Fato no centro, dimens√µes nas pontas | <strong>Agrega√ß√µes R√°pidas:</strong> SUM, COUNT, AVG em colunas otimizadas | <strong>Filtros Intuitivos:</strong> WHERE em atributos descritivos | <strong>Performance:</strong> Queries otimizadas para OLAP</p>
            </div>
            
            <div class="code-block">
                <div class="code-header">
                    <span>üìà Consultas de Business Intelligence</span>
                    <button class="copy-button" onclick="copyCode(this)">Copiar</button>
                </div>
<pre><code><span class="syntax-function">print</span>(<span class="syntax-string">"\n" + "="*60</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"üìà CONSULTAS ANAL√çTICAS"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"="*60</span>)

<span class="syntax-comment"># 1. Vendas por categoria e m√™s</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\n1Ô∏è‚É£ VENDAS POR CATEGORIA E M√äS"</span>)
vendas_categoria_mes = (
    fato_vendas_final
    .merge(dim_produto[[<span class="syntax-string">'product_key'</span>, <span class="syntax-string">'category'</span>]], on=<span class="syntax-string">'product_key'</span>)
    .merge(dim_tempo[[<span class="syntax-string">'date_key'</span>, <span class="syntax-string">'year'</span>, <span class="syntax-string">'month'</span>, <span class="syntax-string">'month_name'</span>]], on=<span class="syntax-string">'date_key'</span>)
    .groupby([<span class="syntax-string">'category'</span>, <span class="syntax-string">'year'</span>, <span class="syntax-string">'month'</span>, <span class="syntax-string">'month_name'</span>])
    .agg({
        <span class="syntax-string">'total_amount'</span>: <span class="syntax-string">'sum'</span>,
        <span class="syntax-string">'quantity'</span>: <span class="syntax-string">'sum'</span>,
        <span class="syntax-string">'transaction_id'</span>: <span class="syntax-string">'count'</span>
    })
    .round(<span class="syntax-number">2</span>)
    .reset_index()
)

<span class="syntax-function">print</span>(vendas_categoria_mes.head(<span class="syntax-number">10</span>))

<span class="syntax-comment"># 2. Top 10 produtos por revenue</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\n2Ô∏è‚É£ TOP 10 PRODUTOS POR REVENUE"</span>)
top_produtos = (
    fato_vendas_final
    .merge(dim_produto[[<span class="syntax-string">'product_key'</span>, <span class="syntax-string">'product_name'</span>, <span class="syntax-string">'category'</span>]], on=<span class="syntax-string">'product_key'</span>)
    .groupby([<span class="syntax-string">'product_name'</span>, <span class="syntax-string">'category'</span>])
    .agg({
        <span class="syntax-string">'total_amount'</span>: <span class="syntax-string">'sum'</span>,
        <span class="syntax-string">'quantity'</span>: <span class="syntax-string">'sum'</span>
    })
    .sort_values(<span class="syntax-string">'total_amount'</span>, ascending=<span class="syntax-keyword">False</span>)
    .head(<span class="syntax-number">10</span>)
    .round(<span class="syntax-number">2</span>)
)

<span class="syntax-function">print</span>(top_produtos)

<span class="syntax-comment"># 3. Performance por regi√£o</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\n3Ô∏è‚É£ PERFORMANCE POR REGI√ÉO"</span>)
vendas_regiao = (
    fato_vendas_final
    .merge(dim_loja[[<span class="syntax-string">'store_key'</span>, <span class="syntax-string">'region'</span>]], on=<span class="syntax-string">'store_key'</span>)
    .groupby(<span class="syntax-string">'region'</span>)
    .agg({
        <span class="syntax-string">'total_amount'</span>: <span class="syntax-string">'sum'</span>,
        <span class="syntax-string">'transaction_id'</span>: <span class="syntax-string">'count'</span>,
        <span class="syntax-string">'customer_key'</span>: <span class="syntax-string">'nunique'</span>
    })
    .round(<span class="syntax-number">2</span>)
    .reset_index()
)
vendas_regiao.columns = [<span class="syntax-string">'region'</span>, <span class="syntax-string">'revenue_total'</span>, <span class="syntax-string">'num_transacoes'</span>, <span class="syntax-string">'clientes_unicos'</span>]
vendas_regiao[<span class="syntax-string">'ticket_medio'</span>] = (vendas_regiao[<span class="syntax-string">'revenue_total'</span>] / vendas_regiao[<span class="syntax-string">'num_transacoes'</span>]).round(<span class="syntax-number">2</span>)

<span class="syntax-function">print</span>(vendas_regiao)</code></pre>
            </div>

            <div class="explanation-box">
                <h5>üîç Consultas Anal√≠ticas Demonstradas:</h5>
                <p><strong>An√°lise Temporal:</strong> Vendas por categoria e m√™s usando JOINs simples | <strong>Ranking:</strong> Top produtos com agrega√ß√µes diretas | <strong>An√°lise Geogr√°fica:</strong> Performance regional com m√∫ltiplas m√©tricas. Note como cada consulta √© um padr√£o simples de JOIN + GROUP BY + agrega√ß√£o - isso √© o poder da modelagem dimensional!</p>
            </div>
        </div>

        <!-- Passo 7: Visualiza√ß√µes -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">7</div>
                <h2 class="step-title">Visualiza√ß√µes e Insights</h2>
            </div>
            <div class="etl-badge">üìä LOAD - Apresenta√ß√£o dos Dados</div>
            <p class="step-description">Esta etapa representa o <strong>"Load"</strong> do processo ETL - carregar os dados transformados em sua forma final para consumo. Aqui, "carregar" significa apresentar os insights atrav√©s de visualiza√ß√µes. Em ambiente corporativo, esta seria a camada de BI (Business Intelligence).</p>
            
            <div class="theory-box">
                <h4>üìä Visualiza√ß√£o = Carregamento para BI</h4>
                <p><strong>Load Tradicional:</strong> Dados carregados em DW/BI tools | <strong>Load Moderno:</strong> Dashboards, relat√≥rios, APIs | <strong>Nosso Exemplo:</strong> Gr√°ficos que demonstram insights dos dados modelados | <strong>Benef√≠cio:</strong> Schema dimensional facilita qualquer tipo de visualiza√ß√£o</p>
            </div>
            
            <div class="code-block">
                <div class="code-header">
                    <span>üìä Dashboard de Visualiza√ß√µes</span>
                    <button class="copy-button" onclick="copyCode(this)">Copiar</button>
                </div>
<pre><code><span class="syntax-function">print</span>(<span class="syntax-string">"\n" + "="*60</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"üìä CRIANDO VISUALIZA√á√ïES"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"="*60</span>)

<span class="syntax-comment"># Configurar layout dos gr√°ficos</span>
plt.figure(figsize=(<span class="syntax-number">15</span>, <span class="syntax-number">12</span>))

<span class="syntax-comment"># 1. Vendas por categoria</span>
plt.subplot(<span class="syntax-number">2</span>, <span class="syntax-number">3</span>, <span class="syntax-number">1</span>)
categoria_revenue = (
    fato_vendas_final
    .merge(dim_produto[[<span class="syntax-string">'product_key'</span>, <span class="syntax-string">'category'</span>]], on=<span class="syntax-string">'product_key'</span>)
    .groupby(<span class="syntax-string">'category'</span>)[<span class="syntax-string">'total_amount'</span>]
    .<span class="syntax-function">sum</span>()
    .sort_values(ascending=<span class="syntax-keyword">True</span>)
)
categoria_revenue.plot(kind=<span class="syntax-string">'barh'</span>, color=<span class="syntax-string">'skyblue'</span>)
plt.title(<span class="syntax-string">'Revenue por Categoria'</span>)
plt.xlabel(<span class="syntax-string">'Revenue (R$)'</span>)

<span class="syntax-comment"># 2. Vendas ao longo do tempo</span>
plt.subplot(<span class="syntax-number">2</span>, <span class="syntax-number">3</span>, <span class="syntax-number">2</span>)
vendas_tempo_data = (
    fato_vendas_final
    .merge(dim_tempo[[<span class="syntax-string">'date_key'</span>, <span class="syntax-string">'date'</span>]], on=<span class="syntax-string">'date_key'</span>)
    .groupby(<span class="syntax-string">'date'</span>)[<span class="syntax-string">'total_amount'</span>]
    .<span class="syntax-function">sum</span>()
)
vendas_tempo_data.index = pd.to_datetime(vendas_tempo_data.index)
vendas_tempo = vendas_tempo_data.resample(<span class="syntax-string">'M'</span>).<span class="syntax-function">sum</span>()

vendas_tempo.plot(kind=<span class="syntax-string">'line'</span>, marker=<span class="syntax-string">'o'</span>, color=<span class="syntax-string">'green'</span>)
plt.title(<span class="syntax-string">'Vendas ao Longo do Tempo'</span>)
plt.xlabel(<span class="syntax-string">'M√™s'</span>)
plt.ylabel(<span class="syntax-string">'Revenue (R$)'</span>)
plt.xticks(rotation=<span class="syntax-number">45</span>)

<span class="syntax-comment"># 3. Distribui√ß√£o por faixa et√°ria</span>
plt.subplot(<span class="syntax-number">2</span>, <span class="syntax-number">3</span>, <span class="syntax-number">3</span>)
vendas_idade = (
    fato_vendas_final
    .merge(dim_cliente[[<span class="syntax-string">'customer_key'</span>, <span class="syntax-string">'age_group'</span>]], on=<span class="syntax-string">'customer_key'</span>)
    .groupby(<span class="syntax-string">'age_group'</span>)[<span class="syntax-string">'total_amount'</span>]
    .<span class="syntax-function">sum</span>()
)
plt.pie(vendas_idade.values, labels=vendas_idade.index, autopct=<span class="syntax-string">'%1.1f%%'</span>)
plt.title(<span class="syntax-string">'Vendas por Faixa Et√°ria'</span>)

<span class="syntax-comment"># 4. Performance por regi√£o</span>
plt.subplot(<span class="syntax-number">2</span>, <span class="syntax-number">3</span>, <span class="syntax-number">4</span>)
vendas_regiao_plot = (
    fato_vendas_final
    .merge(dim_loja[[<span class="syntax-string">'store_key'</span>, <span class="syntax-string">'region'</span>]], on=<span class="syntax-string">'store_key'</span>)
    .groupby(<span class="syntax-string">'region'</span>)[<span class="syntax-string">'total_amount'</span>]
    .<span class="syntax-function">sum</span>()
    .sort_values(ascending=<span class="syntax-keyword">False</span>)
)
vendas_regiao_plot.plot(kind=<span class="syntax-string">'bar'</span>, color=<span class="syntax-string">'orange'</span>)
plt.title(<span class="syntax-string">'Revenue por Regi√£o'</span>)
plt.xlabel(<span class="syntax-string">'Regi√£o'</span>)
plt.ylabel(<span class="syntax-string">'Revenue (R$)'</span>)
plt.xticks(rotation=<span class="syntax-number">45</span>)

<span class="syntax-comment"># 5. M√©todos de pagamento</span>
plt.subplot(<span class="syntax-number">2</span>, <span class="syntax-number">3</span>, <span class="syntax-number">5</span>)
pagamento_dist = fato_vendas_final[<span class="syntax-string">'payment_method'</span>].value_counts()
pagamento_dist.plot(kind=<span class="syntax-string">'bar'</span>, color=<span class="syntax-string">'purple'</span>)
plt.title(<span class="syntax-string">'Distribui√ß√£o por M√©todo de Pagamento'</span>)
plt.xlabel(<span class="syntax-string">'M√©todo'</span>)
plt.ylabel(<span class="syntax-string">'N√∫mero de Transa√ß√µes'</span>)
plt.xticks(rotation=<span class="syntax-number">45</span>)

<span class="syntax-comment"># 6. Sazonalidade por dia da semana</span>
plt.subplot(<span class="syntax-number">2</span>, <span class="syntax-number">3</span>, <span class="syntax-number">6</span>)
vendas_dia_semana = (
    fato_vendas_final
    .merge(dim_tempo[[<span class="syntax-string">'date_key'</span>, <span class="syntax-string">'day_name'</span>]], on=<span class="syntax-string">'date_key'</span>)
    .groupby(<span class="syntax-string">'day_name'</span>)[<span class="syntax-string">'total_amount'</span>]
    .<span class="syntax-function">sum</span>()
    .reindex([<span class="syntax-string">'Monday'</span>, <span class="syntax-string">'Tuesday'</span>, <span class="syntax-string">'Wednesday'</span>, <span class="syntax-string">'Thursday'</span>, <span class="syntax-string">'Friday'</span>, <span class="syntax-string">'Saturday'</span>, <span class="syntax-string">'Sunday'</span>])
)
vendas_dia_semana.plot(kind=<span class="syntax-string">'bar'</span>, color=<span class="syntax-string">'red'</span>)
plt.title(<span class="syntax-string">'Vendas por Dia da Semana'</span>)
plt.xlabel(<span class="syntax-string">'Dia'</span>)
plt.ylabel(<span class="syntax-string">'Revenue (R$)'</span>)
plt.xticks(rotation=<span class="syntax-number">45</span>)

plt.tight_layout()
plt.show()

<span class="syntax-function">print</span>(<span class="syntax-string">"\nüéâ Visualiza√ß√µes criadas com sucesso!"</span>)</code></pre>
            </div>

            <div class="explanation-box">
                <h5>üîç Dashboard Multidimensional:</h5>
                <p><strong>6 Perspectivas Diferentes:</strong> Cada gr√°fico explora uma dimens√£o diferente (categoria, tempo, idade, regi√£o, pagamento, sazonalidade) | <strong>Facilidade de Cria√ß√£o:</strong> Cada visualiza√ß√£o √© uma consulta simples no nosso modelo dimensional | <strong>Insights Ricos:</strong> Padr√µes comportamentais, tend√™ncias temporais, performance geogr√°fica - tudo facilmente acess√≠vel.</p>
            </div>
        </div>

        <!-- Passo 8: Resumo Final -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">8</div>
                <h2 class="step-title">Resumo e Pr√≥ximos Passos</h2>
            </div>
            <div class="etl-badge">üéØ CONSOLIDA√á√ÉO - Li√ß√µes Aprendidas</div>
            <p class="step-description">Chegamos ao final do nosso pipeline ETL completo! Vamos consolidar tudo que foi demonstrado e conectar com a pr√≥xima aula. Este resumo mostra como implementamos na pr√°tica todos os conceitos te√≥ricos da aula sobre transforma√ß√µes e modelagem dimensional.</p>
            
            <div class="theory-box">
                <h4>üèóÔ∏è Pipeline ETL Completo Implementado</h4>
                <p><strong>Extract:</strong> Simulamos dados de m√∫ltiplas fontes | <strong>Transform:</strong> Aplicamos 4 tipos de transforma√ß√£o | <strong>Load:</strong> Criamos modelo dimensional otimizado | <strong>BI:</strong> Demonstramos consultas e visualiza√ß√µes facilitadas</p>
            </div>
            
            <div class="code-block">
                <div class="code-header">
                    <span>üéØ Resumo Final</span>
                    <button class="copy-button" onclick="copyCode(this)">Copiar</button>
                </div>
<pre><code><span class="syntax-function">print</span>(<span class="syntax-string">"\n" + "="*60</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"üéØ RESUMO E LI√á√ïES APRENDIDAS"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"="*60</span>)

<span class="syntax-function">print</span>(<span class="syntax-string">f"""
‚úÖ TRANSFORMA√á√ïES APLICADAS:
   ‚Ä¢ Limpeza: Remo√ß√£o de produtos inativos e transa√ß√µes inv√°lidas
   ‚Ä¢ Padroniza√ß√£o: Convers√£o de moedas e formata√ß√£o de datas
   ‚Ä¢ Deriva√ß√µes: C√°lculo de idade, faixas et√°rias, valores finais
   ‚Ä¢ Agrega√ß√µes: Estat√≠sticas por produto e per√≠odo

‚≠ê SCHEMA DIMENSIONAL CRIADO:
   ‚Ä¢ 4 Tabelas de Dimens√£o (Tempo, Cliente, Produto, Loja)
   ‚Ä¢ 1 Tabela Fato (Vendas) com granularidade por item
   ‚Ä¢ Star Schema implementado com integridade referencial
   ‚Ä¢ {len(fato_vendas_final):,} fatos conectados a {len(dim_tempo) + len(dim_cliente) + len(dim_produto) + len(dim_loja):,} registros dimensionais

üìä CONSULTAS ANAL√çTICAS FACILITADAS:
   ‚Ä¢ An√°lise temporal: vendas por m√™s/trimestre/ano
   ‚Ä¢ Segmenta√ß√£o: performance por categoria/regi√£o/idade
   ‚Ä¢ Ranking: top produtos e clientes mais valiosos
   ‚Ä¢ Padr√µes: sazonalidade e tend√™ncias de comportamento

üí° BENEF√çCIOS DEMONSTRADOS:
   ‚Ä¢ Consultas complexas tornam-se JOINs simples
   ‚Ä¢ Performance otimizada para an√°lises
   ‚Ä¢ Modelo intuitivo para usu√°rios de neg√≥cio
   ‚Ä¢ Escalabilidade para grandes volumes de dados
"""</span>)

<span class="syntax-function">print</span>(<span class="syntax-string">f"üöÄ PR√ìXIMOS PASSOS (Aula 11/08):"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"   ‚Ä¢ Aplicar m√©todos quantitativos nos dados estruturados"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"   ‚Ä¢ Estat√≠stica descritiva sobre as dimens√µes e fatos"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"   ‚Ä¢ An√°lise de distribui√ß√µes e amostragem"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"   ‚Ä¢ Checkpoint 1 do projeto com modelagem dimensional"</span>)

<span class="syntax-function">print</span>(<span class="syntax-string">f"\n" + "="*60</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"‚ú® EXEMPLO PR√ÅTICO CONCLU√çDO COM SUCESSO!"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"="*60</span>)</code></pre>
            </div>

            <div class="explanation-box">
                <h5>üîç O que Aprendemos na Pr√°tica:</h5>
                <p><strong>ETL Real:</strong> Como dados heterog√™neos s√£o transformados sistematicamente | <strong>Modelagem Dimensional:</strong> Star Schema na pr√°tica com 4 dimens√µes e 1 fato | <strong>Business Intelligence:</strong> Como consultas complexas se tornam simples | <strong>Prepara√ß√£o:</strong> Dados estruturados prontos para m√©todos quantitativos da pr√≥xima aula</p>
            </div>
        </div>

        <div class="warning-box">
            <h4>‚ö†Ô∏è Dicas Importantes</h4>
            <ul class="list">
                <li>Execute cada bloco em sequ√™ncia - n√£o pule passos</li>
                <li>Se houver erro, volte ao bloco anterior e verifique</li>
                <li>Os gr√°ficos podem demorar alguns segundos para aparecer</li>
                <li>Experimente modificar par√¢metros para ver resultados diferentes</li>
                <li>Salve o notebook no seu Google Drive para futuras consultas</li>
            </ul>
        </div>

        <div class="highlight-box">
            <h4>üöÄ Parab√©ns!</h4>
            <p>Voc√™ implementou com sucesso um pipeline completo de ETL e modelagem dimensional! Este exemplo demonstra na pr√°tica como dados brutos s√£o transformados em estruturas anal√≠ticas otimizadas para Business Intelligence. Os dados estruturados desta forma ser√£o a base perfeita para aplicar m√©todos quantitativos na pr√≥xima aula.</p>
        </div>

        <div class="info-panel">
            <h4>üìö Checkpoint 1 do Projeto</h4>
            <p>Para o Checkpoint 1 da pr√≥xima aula, use este exemplo como refer√™ncia para:</p>
            <ul class="list">
                <li>Definir o dataset do seu projeto de grupo</li>
                <li>Esbo√ßar a modelagem dimensional proposta</li>
                <li>Identificar que transforma√ß√µes ser√£o necess√°rias</li>
                <li>Planejar que perguntas de neg√≥cio voc√™s querem responder</li>
            </ul>
        </div>

        <div style="text-align: center; margin-top: 40px;">
            <a href="https://colab.research.google.com" target="_blank" class="button">üöÄ Abrir Google Colab</a>
        </div>
    </div>

    <script>
        function copyCode(button) {
            const codeBlock = button.closest('.code-block');
            const code = codeBlock.querySelector('pre code').textContent;
            
            navigator.clipboard.writeText(code).then(function() {
                button.textContent = 'Copiado!';
                button.style.background = '#4caf50';
                
                setTimeout(function() {
                    button.textContent = 'Copiar';
                    button.style.background = '#0052cc';
                }, 2000);
            }).catch(function(err) {
                console.error('Erro ao copiar: ', err);
                button.textContent = 'Erro';
                button.style.background = '#f44336';
                
                setTimeout(function() {
                    button.textContent = 'Copiar';
                    button.style.background = '#0052cc';
                }, 2000);
            });
        }

        // Anima√ß√£o suave dos elementos ao carregar
        document.addEventListener('DOMContentLoaded', function() {
            const elements = document.querySelectorAll('.step-container, .highlight-box, .warning-box');
            
            elements.forEach((element, index) => {
                element.style.opacity = '0';
                element.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    element.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
                    element.style.opacity = '1';
                    element.style.transform = 'translateY(0)';
                }, index * 150);
            });
        });
    </script>
</body>
</html>
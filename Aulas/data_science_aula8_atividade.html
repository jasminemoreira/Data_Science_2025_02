<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistemas Inteligentes - Aula 8</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', system-ui, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
            color: #1a1a1a;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(30, 60, 114, 0.3);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .badge {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 20px;
        }

        .title {
            font-size: 2.8rem;
            font-weight: 700;
            color: #1e3c72;
            margin-bottom: 16px;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 30px;
        }

        .section {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            border-left: 5px solid #1e3c72;
        }

        .section h2 {
            color: #1e3c72;
            font-size: 1.8rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section p {
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 24px;
            border: 1px solid rgba(30, 60, 114, 0.2);
            transition: transform 0.3s ease;
        }

        .card:hover { transform: translateY(-3px); }

        .card h3 {
            color: #1e3c72;
            font-size: 1.3rem;
            margin-bottom: 12px;
        }

        .highlight-box {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            padding: 30px;
            border-radius: 16px;
            margin: 25px 0;
        }

        .highlight-box h3 {
            color: white;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .code-block {
            background: #1e1e1e;
            color: #e8e8e8;
            padding: 20px;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 15px 0;
            border-left: 4px solid #1e3c72;
        }

        .code-header {
            background: #2d2d2d;
            color: #fff;
            padding: 8px 16px;
            margin: -20px -20px 12px -20px;
            border-radius: 12px 12px 0 0;
            font-size: 12px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .step-indicator {
            background: #1e3c72;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 18px;
        }

        .checkpoint-box {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            padding: 25px;
            border-radius: 16px;
            margin: 25px 0;
        }

        .checkpoint-box h3 {
            color: white;
            margin-bottom: 12px;
        }

        .tool-info {
            background: rgba(30, 60, 114, 0.1);
            border: 2px solid rgba(30, 60, 114, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .tool-info h4 {
            color: #1e3c72;
            margin-bottom: 10px;
        }

        .concept-box {
            background: rgba(42, 82, 152, 0.1);
            border: 2px solid rgba(42, 82, 152, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .concept-box h4 {
            color: #2a5298;
            margin-bottom: 10px;
        }

        .syntax-keyword { color: #569cd6; }
        .syntax-string { color: #ce9178; }
        .syntax-comment { color: #6a9955; }
        .syntax-number { color: #b5cea8; }
        .syntax-function { color: #dcdcaa; }

        .success-box {
            background: rgba(40, 167, 69, 0.1);
            border: 2px solid rgba(40, 167, 69, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #28a745;
        }

        .warning-box {
            background: rgba(255, 193, 7, 0.1);
            border: 2px solid rgba(255, 193, 7, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #ffc107;
        }

        .exercise-box {
            background: rgba(156, 39, 176, 0.1);
            border: 2px solid rgba(156, 39, 176, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .exercise-box h4 {
            color: #9c27b0;
            margin-bottom: 10px;
        }

        .colab-link {
            background: #F9AB00;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            display: inline-block;
            margin: 10px 0;
            font-weight: 600;
        }

        .colab-link:hover {
            background: #e69500;
        }

        @media (max-width: 768px) {
            .container { padding: 20px; margin: 10px; }
            .title { font-size: 2.2rem; }
            .grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="badge">Aula 8 - 16/09</div>
            <h1 class="title">Python para Engenharia de Produção</h1>
            <p class="subtitle">Análise de Dados, Otimização e Machine Learning Aplicado</p>
        </div>

        <div class="highlight-box">
            <h3>Unidade III: Implementação Prática com Python</h3>
            <p>Nesta aula vamos implementar soluções reais usando Python no Google Colab. Trabalharemos com bibliotecas modernas para análise de dados industriais, otimização de processos e aplicações de machine learning em problemas típicos da engenharia de produção.</p>
        </div>

        <div class="checkpoint-box">
            <h3>Programa da Aula</h3>
            <p><strong>Parte 1:</strong> Setup do Ambiente e Bibliotecas Essenciais<br>
            <strong>Parte 2:</strong> Análise de Dados de Produção com Pandas<br>
            <strong>Parte 3:</strong> Visualização de KPIs Industriais<br>
            <strong>Parte 4:</strong> Otimização Linear com PuLP<br>
            <strong>Parte 5:</strong> Previsão de Demanda com Prophet<br>
            <strong>Parte 6:</strong> Detecção de Anomalias em Processos<br>
            <strong>Parte 7:</strong> Dashboard Interativo com Plotly<br>
            <strong>Parte 8:</strong> Projeto Integrado</p>
        </div>

        <div class="section">
            <h2><span class="step-indicator">1</span>Setup do Ambiente Google Colab</h2>
            <p>Vamos configurar o ambiente com as bibliotecas mais atuais e relevantes para análise de dados industriais.</p>

            <div class="tool-info">
                <h4>Bibliotecas Python para Engenharia (2025)</h4>
                <p><strong>pandas 2.2+:</strong> Manipulação e análise de dados estruturados<br>
                <strong>numpy 2.0+:</strong> Computação numérica e arrays<br>
                <strong>matplotlib 3.9+ / seaborn 0.13+:</strong> Visualização estática<br>
                <strong>plotly 5.24+:</strong> Gráficos interativos<br>
                <strong>scikit-learn 1.5+:</strong> Machine Learning<br>
                <strong>prophet 1.1+:</strong> Previsão de séries temporais<br>
                <strong>PuLP 2.9+:</strong> Otimização linear<br>
                <strong>scipy 1.14+:</strong> Computação científica</p>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span>Instalação de Pacotes no Colab</span>
                </div>
<pre><code><span class="syntax-comment"># Instalar pacotes adicionais não incluídos no Colab</span>
<span class="syntax-keyword">!</span>pip install prophet pulp plotly -q

<span class="syntax-comment"># Imports principais</span>
<span class="syntax-keyword">import</span> pandas <span class="syntax-keyword">as</span> pd
<span class="syntax-keyword">import</span> numpy <span class="syntax-keyword">as</span> np
<span class="syntax-keyword">import</span> matplotlib.pyplot <span class="syntax-keyword">as</span> plt
<span class="syntax-keyword">import</span> seaborn <span class="syntax-keyword">as</span> sns
<span class="syntax-keyword">import</span> plotly.express <span class="syntax-keyword">as</span> px
<span class="syntax-keyword">import</span> plotly.graph_objects <span class="syntax-keyword">as</span> go
<span class="syntax-keyword">from</span> sklearn.preprocessing <span class="syntax-keyword">import</span> StandardScaler
<span class="syntax-keyword">from</span> sklearn.cluster <span class="syntax-keyword">import</span> KMeans
<span class="syntax-keyword">from</span> scipy <span class="syntax-keyword">import</span> stats
<span class="syntax-keyword">from</span> pulp <span class="syntax-keyword">import</span> *
<span class="syntax-keyword">from</span> prophet <span class="syntax-keyword">import</span> Prophet

<span class="syntax-comment"># Configurações de visualização</span>
plt.style.use(<span class="syntax-string">'seaborn-v0_8-darkgrid'</span>)
sns.set_palette(<span class="syntax-string">"husl"</span>)
pd.set_option(<span class="syntax-string">'display.max_columns'</span>, <span class="syntax-number">None</span>)

<span class="syntax-function">print</span>(<span class="syntax-string">"Ambiente configurado com sucesso!"</span>)</code></pre>
            </div>
        </div>

        <div class="section">
            <h2><span class="step-indicator">2</span>Análise de Dados de Produção</h2>
            <p>Vamos criar e analisar um dataset simulado de produção industrial com métricas realistas.</p>

            <div class="code-block">
                <div class="code-header">
                    <span>Geração de Dados Sintéticos de Produção</span>
                </div>
<pre><code><span class="syntax-comment"># Gerar dados simulados de produção por 6 meses</span>
np.random.seed(<span class="syntax-number">42</span>)

<span class="syntax-comment"># Criar datas para 180 dias</span>
dates = pd.date_range(start=<span class="syntax-string">'2024-03-01'</span>, periods=<span class="syntax-number">180</span>, freq=<span class="syntax-string">'D'</span>)

<span class="syntax-comment"># Simular produção com sazonalidade e tendência</span>
trend = np.linspace(<span class="syntax-number">800</span>, <span class="syntax-number">950</span>, <span class="syntax-number">180</span>)
seasonal = <span class="syntax-number">50</span> * np.sin(np.linspace(<span class="syntax-number">0</span>, <span class="syntax-number">4</span>*np.pi, <span class="syntax-number">180</span>))
noise = np.random.normal(<span class="syntax-number">0</span>, <span class="syntax-number">30</span>, <span class="syntax-number">180</span>)
producao = trend + seasonal + noise

<span class="syntax-comment"># Criar DataFrame com múltiplas métricas</span>
df_producao = pd.DataFrame({
    <span class="syntax-string">'data'</span>: dates,
    <span class="syntax-string">'producao_unidades'</span>: producao.astype(int),
    <span class="syntax-string">'meta_diaria'</span>: <span class="syntax-number">900</span>,
    <span class="syntax-string">'tempo_setup_min'</span>: np.random.randint(<span class="syntax-number">45</span>, <span class="syntax-number">120</span>, <span class="syntax-number">180</span>),
    <span class="syntax-string">'refugo_pct'</span>: np.random.uniform(<span class="syntax-number">0.5</span>, <span class="syntax-number">3.5</span>, <span class="syntax-number">180</span>),
    <span class="syntax-string">'disponibilidade_pct'</span>: np.random.uniform(<span class="syntax-number">85</span>, <span class="syntax-number">98</span>, <span class="syntax-number">180</span>),
    <span class="syntax-string">'performance_pct'</span>: np.random.uniform(<span class="syntax-number">80</span>, <span class="syntax-number">95</span>, <span class="syntax-number">180</span>),
    <span class="syntax-string">'qualidade_pct'</span>: <span class="syntax-number">100</span> - np.random.uniform(<span class="syntax-number">0.5</span>, <span class="syntax-number">3.5</span>, <span class="syntax-number">180</span>)
})

<span class="syntax-comment"># Calcular OEE</span>
df_producao[<span class="syntax-string">'oee'</span>] = (
    df_producao[<span class="syntax-string">'disponibilidade_pct'</span>] * 
    df_producao[<span class="syntax-string">'performance_pct'</span>] * 
    df_producao[<span class="syntax-string">'qualidade_pct'</span>]
) / <span class="syntax-number">10000</span>

<span class="syntax-comment"># Adicionar turno e dia da semana</span>
df_producao[<span class="syntax-string">'dia_semana'</span>] = df_producao[<span class="syntax-string">'data'</span>].dt.day_name()
df_producao[<span class="syntax-string">'mes'</span>] = df_producao[<span class="syntax-string">'data'</span>].dt.month

<span class="syntax-comment"># Estatísticas descritivas</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"Estatísticas de Produção:"</span>)
<span class="syntax-function">print</span>(df_producao[[<span class="syntax-string">'producao_unidades'</span>, <span class="syntax-string">'oee'</span>, <span class="syntax-string">'refugo_pct'</span>]].describe())</code></pre>
            </div>

            <div class="exercise-box">
                <h4>Exercício 1: Análise Exploratória</h4>
                <p>Execute o código acima e depois calcule:
                <br>1. Qual o dia da semana com maior produção média?
                <br>2. Existe correlação entre tempo de setup e refugo?
                <br>3. Quantos dias a produção ficou abaixo da meta?</p>
            </div>
        </div>

        <div class="section">
            <h2><span class="step-indicator">3</span>Visualização de KPIs Industriais</h2>
            <p>Criar visualizações profissionais para análise de indicadores de produção.</p>

            <div class="code-block">
                <div class="code-header">
                    <span>Dashboards de Produção</span>
                </div>
<pre><code><span class="syntax-comment"># 1. Gráfico de Produção vs Meta</span>
fig, axes = plt.subplots(<span class="syntax-number">2</span>, <span class="syntax-number">2</span>, figsize=(<span class="syntax-number">16</span>, <span class="syntax-number">10</span>))

<span class="syntax-comment"># Produção ao longo do tempo</span>
axes[<span class="syntax-number">0</span>, <span class="syntax-number">0</span>].plot(df_producao[<span class="syntax-string">'data'</span>], df_producao[<span class="syntax-string">'producao_unidades'</span>], 
              label=<span class="syntax-string">'Produção Real'</span>, linewidth=<span class="syntax-number">2</span>)
axes[<span class="syntax-number">0</span>, <span class="syntax-number">0</span>].axhline(y=<span class="syntax-number">900</span>, color=<span class="syntax-string">'r'</span>, linestyle=<span class="syntax-string">'--'</span>, label=<span class="syntax-string">'Meta'</span>)
axes[<span class="syntax-number">0</span>, <span class="syntax-number">0</span>].set_title(<span class="syntax-string">'Produção Diária vs Meta'</span>, fontsize=<span class="syntax-number">14</span>, fontweight=<span class="syntax-string">'bold'</span>)
axes[<span class="syntax-number">0</span>, <span class="syntax-number">0</span>].legend()

<span class="syntax-comment"># Distribuição do OEE</span>
axes[<span class="syntax-number">0</span>, <span class="syntax-number">1</span>].hist(df_producao[<span class="syntax-string">'oee'</span>], bins=<span class="syntax-number">30</span>, edgecolor=<span class="syntax-string">'black'</span>, alpha=<span class="syntax-number">0.7</span>)
axes[<span class="syntax-number">0</span>, <span class="syntax-number">1</span>].axvline(x=df_producao[<span class="syntax-string">'oee'</span>].mean(), color=<span class="syntax-string">'r'</span>, 
              linestyle=<span class="syntax-string">'--'</span>, label=<span class="syntax-string">f'Média: {df_producao["oee"].mean():.1f}%'</span>)
axes[<span class="syntax-number">0</span>, <span class="syntax-number">1</span>].set_title(<span class="syntax-string">'Distribuição do OEE'</span>, fontsize=<span class="syntax-number">14</span>, fontweight=<span class="syntax-string">'bold'</span>)
axes[<span class="syntax-number">0</span>, <span class="syntax-number">1</span>].legend()

<span class="syntax-comment"># Produção por dia da semana</span>
prod_por_dia = df_producao.groupby(<span class="syntax-string">'dia_semana'</span>)[<span class="syntax-string">'producao_unidades'</span>].mean()
dias_ordem = [<span class="syntax-string">'Monday'</span>, <span class="syntax-string">'Tuesday'</span>, <span class="syntax-string">'Wednesday'</span>, <span class="syntax-string">'Thursday'</span>, <span class="syntax-string">'Friday'</span>]
prod_por_dia = prod_por_dia.reindex(dias_ordem)
axes[<span class="syntax-number">1</span>, <span class="syntax-number">0</span>].bar(range(len(prod_por_dia)), prod_por_dia.values)
axes[<span class="syntax-number">1</span>, <span class="syntax-number">0</span>].set_xticks(range(len(prod_por_dia)))
axes[<span class="syntax-number">1</span>, <span class="syntax-number">0</span>].set_xticklabels([<span class="syntax-string">'Seg'</span>, <span class="syntax-string">'Ter'</span>, <span class="syntax-string">'Qua'</span>, <span class="syntax-string">'Qui'</span>, <span class="syntax-string">'Sex'</span>])
axes[<span class="syntax-number">1</span>, <span class="syntax-number">0</span>].set_title(<span class="syntax-string">'Produção Média por Dia da Semana'</span>, fontsize=<span class="syntax-number">14</span>, fontweight=<span class="syntax-string">'bold'</span>)

<span class="syntax-comment"># Correlação entre variáveis</span>
correlacao = df_producao[[<span class="syntax-string">'tempo_setup_min'</span>, <span class="syntax-string">'refugo_pct'</span>, 
                          <span class="syntax-string">'oee'</span>, <span class="syntax-string">'producao_unidades'</span>]].corr()
im = axes[<span class="syntax-number">1</span>, <span class="syntax-number">1</span>].imshow(correlacao, cmap=<span class="syntax-string">'coolwarm'</span>, aspect=<span class="syntax-string">'auto'</span>)
axes[<span class="syntax-number">1</span>, <span class="syntax-number">1</span>].set_xticks(range(len(correlacao.columns)))
axes[<span class="syntax-number">1</span>, <span class="syntax-number">1</span>].set_yticks(range(len(correlacao.columns)))
axes[<span class="syntax-number">1</span>, <span class="syntax-number">1</span>].set_xticklabels(correlacao.columns, rotation=<span class="syntax-number">45</span>, ha=<span class="syntax-string">'right'</span>)
axes[<span class="syntax-number">1</span>, <span class="syntax-number">1</span>].set_yticklabels(correlacao.columns)
plt.colorbar(im, ax=axes[<span class="syntax-number">1</span>, <span class="syntax-number">1</span>])
axes[<span class="syntax-number">1</span>, <span class="syntax-number">1</span>].set_title(<span class="syntax-string">'Matriz de Correlação'</span>, fontsize=<span class="syntax-number">14</span>, fontweight=<span class="syntax-string">'bold'</span>)

plt.tight_layout()
plt.show()</code></pre>
            </div>
        </div>

        <div class="section">
            <h2><span class="step-indicator">4</span>Otimização Linear: Mix de Produção</h2>
            <p>Resolver problema clássico de otimização de mix de produtos usando programação linear.</p>

            <div class="concept-box">
                <h4>Problema de Mix de Produção</h4>
                <p>Uma fábrica produz 3 produtos diferentes com recursos limitados. Queremos maximizar o lucro total respeitando as restrições de capacidade, demanda e matéria-prima.</p>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span>Otimização com PuLP</span>
                </div>
<pre><code><span class="syntax-comment"># Dados do problema</span>
produtos = [<span class="syntax-string">'Produto_A'</span>, <span class="syntax-string">'Produto_B'</span>, <span class="syntax-string">'Produto_C'</span>]
lucro = {<span class="syntax-string">'Produto_A'</span>: <span class="syntax-number">40</span>, <span class="syntax-string">'Produto_B'</span>: <span class="syntax-number">30</span>, <span class="syntax-string">'Produto_C'</span>: <span class="syntax-number">50</span>}
tempo_producao = {<span class="syntax-string">'Produto_A'</span>: <span class="syntax-number">2</span>, <span class="syntax-string">'Produto_B'</span>: <span class="syntax-number">1</span>, <span class="syntax-string">'Produto_C'</span>: <span class="syntax-number">3</span>}
materia_prima = {<span class="syntax-string">'Produto_A'</span>: <span class="syntax-number">3</span>, <span class="syntax-string">'Produto_B'</span>: <span class="syntax-number">2</span>, <span class="syntax-string">'Produto_C'</span>: <span class="syntax-number">4</span>}
demanda_max = {<span class="syntax-string">'Produto_A'</span>: <span class="syntax-number">200</span>, <span class="syntax-string">'Produto_B'</span>: <span class="syntax-number">300</span>, <span class="syntax-string">'Produto_C'</span>: <span class="syntax-number">150</span>}

<span class="syntax-comment"># Recursos disponíveis</span>
horas_disponiveis = <span class="syntax-number">600</span>
materia_prima_disponivel = <span class="syntax-number">800</span>

<span class="syntax-comment"># Criar problema de otimização</span>
prob = LpProblem(<span class="syntax-string">"Mix_Producao"</span>, LpMaximize)

<span class="syntax-comment"># Variáveis de decisão</span>
x = LpVariable.dicts(<span class="syntax-string">"Quantidade"</span>, produtos, lowBound=<span class="syntax-number">0</span>, cat=<span class="syntax-string">'Integer'</span>)

<span class="syntax-comment"># Função objetivo: Maximizar lucro</span>
prob += lpSum([lucro[i] * x[i] <span class="syntax-keyword">for</span> i <span class="syntax-keyword">in</span> produtos]), <span class="syntax-string">"Lucro_Total"</span>

<span class="syntax-comment"># Restrições</span>
prob += lpSum([tempo_producao[i] * x[i] <span class="syntax-keyword">for</span> i <span class="syntax-keyword">in</span> produtos]) <= horas_disponiveis, <span class="syntax-string">"Tempo"</span>
prob += lpSum([materia_prima[i] * x[i] <span class="syntax-keyword">for</span> i <span class="syntax-keyword">in</span> produtos]) <= materia_prima_disponivel, <span class="syntax-string">"Materia_Prima"</span>

<span class="syntax-keyword">for</span> i <span class="syntax-keyword">in</span> produtos:
    prob += x[i] <= demanda_max[i], <span class="syntax-string">f"Demanda_{i}"</span>

<span class="syntax-comment"># Resolver</span>
prob.solve()

<span class="syntax-comment"># Resultados</span>
<span class="syntax-function">print</span>(<span class="syntax-string">f"Status: {LpStatus[prob.status]}"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"\nLucro Máximo: R$ {value(prob.objective):,.2f}"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">"\nQuantidades Ótimas:"</span>)
<span class="syntax-keyword">for</span> i <span class="syntax-keyword">in</span> produtos:
    <span class="syntax-function">print</span>(<span class="syntax-string">f"  {i}: {x[i].varValue:.0f} unidades"</span>)

<span class="syntax-comment"># Análise de utilização de recursos</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\nUtilização de Recursos:"</span>)
tempo_usado = sum([tempo_producao[i] * x[i].varValue <span class="syntax-keyword">for</span> i <span class="syntax-keyword">in</span> produtos])
mp_usado = sum([materia_prima[i] * x[i].varValue <span class="syntax-keyword">for</span> i <span class="syntax-keyword">in</span> produtos])
<span class="syntax-function">print</span>(<span class="syntax-string">f"  Tempo: {tempo_usado:.0f}/{horas_disponiveis} horas ({tempo_usado/horas_disponiveis*100:.1f}%)"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"  Matéria-Prima: {mp_usado:.0f}/{materia_prima_disponivel} kg ({mp_usado/materia_prima_disponivel*100:.1f}%)"</span>)</code></pre>
            </div>

            <div class="exercise-box">
                <h4>Exercício 2: Cenários de Otimização</h4>
                <p>Modifique o código acima e avalie:
                <br>1. O que acontece se aumentarmos as horas disponíveis para 700?
                <br>2. Qual recurso é o gargalo principal?
                <br>3. Se pudermos comprar mais matéria-prima, quanto devemos comprar?</p>
            </div>
        </div>

        <div class="section">
            <h2><span class="step-indicator">5</span>Previsão de Demanda com Prophet</h2>
            <p>Usar o Prophet (desenvolvido pelo Facebook) para prever demanda futura com sazonalidade.</p>

            <div class="code-block">
                <div class="code-header">
                    <span>Série Temporal com Prophet</span>
                </div>
<pre><code><span class="syntax-comment"># Preparar dados para o Prophet (requer colunas 'ds' e 'y')</span>
df_prophet = df_producao[[<span class="syntax-string">'data'</span>, <span class="syntax-string">'producao_unidades'</span>]].copy()
df_prophet.columns = [<span class="syntax-string">'ds'</span>, <span class="syntax-string">'y'</span>]

<span class="syntax-comment"># Criar e treinar modelo</span>
modelo = Prophet(
    daily_seasonality=<span class="syntax-number">False</span>,
    weekly_seasonality=<span class="syntax-number">True</span>,
    yearly_seasonality=<span class="syntax-number">False</span>,
    changepoint_prior_scale=<span class="syntax-number">0.05</span>
)

modelo.fit(df_prophet)

<span class="syntax-comment"># Fazer previsões para 60 dias</span>
futuro = modelo.make_future_dataframe(periods=<span class="syntax-number">60</span>)
previsao = modelo.predict(futuro)

<span class="syntax-comment"># Visualizar</span>
fig = modelo.plot(previsao)
plt.title(<span class="syntax-string">'Previsão de Produção - Próximos 60 Dias'</span>, fontsize=<span class="syntax-number">14</span>, fontweight=<span class="syntax-string">'bold'</span>)
plt.xlabel(<span class="syntax-string">'Data'</span>)
plt.ylabel(<span class="syntax-string">'Unidades Produzidas'</span>)
plt.tight_layout()
plt.show()

<span class="syntax-comment"># Componentes do modelo</span>
fig2 = modelo.plot_components(previsao)
plt.tight_layout()
plt.show()

<span class="syntax-comment"># Estatísticas da previsão</span>
previsao_futuro = previsao.tail(<span class="syntax-number">60</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"\nPrevisão Média (próximos 60 dias): {previsao_futuro['yhat'].mean():.0f} unidades"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"Intervalo de Confiança: [{previsao_futuro['yhat_lower'].mean():.0f}, {previsao_futuro['yhat_upper'].mean():.0f}]"</span>)</code></pre>
            </div>

            <div class="success-box">
                <h4>Vantagens do Prophet</h4>
                <p>Lida automaticamente com sazonalidade, feriados e dados faltantes. Robusto a outliers e mudanças de tendência. Interface simples e resultados interpretáveis. Ideal para dados de negócios com padrões sazonais.</p>
            </div>
        </div>

        <div class="section">
            <h2><span class="step-indicator">6</span>Detecção de Anomalias em Processos</h2>
            <p>Identificar automaticamente comportamentos anormais na produção usando técnicas estatísticas.</p>

            <div class="code-block">
                <div class="code-header">
                    <span>Detecção de Anomalias</span>
                </div>
<pre><code><span class="syntax-comment"># Método 1: Z-Score (desvios padrão)</span>
<span class="syntax-keyword">def</span> <span class="syntax-function">detectar_anomalias_zscore</span>(df, coluna, threshold=<span class="syntax-number">3</span>):
    media = df[coluna].mean()
    desvio = df[coluna].std()
    z_scores = np.abs((df[coluna] - media) / desvio)
    <span class="syntax-keyword">return</span> z_scores > threshold

<span class="syntax-comment"># Método 2: IQR (Intervalo Interquartil)</span>
<span class="syntax-keyword">def</span> <span class="syntax-function">detectar_anomalias_iqr</span>(df, coluna):
    Q1 = df[coluna].quantile(<span class="syntax-number">0.25</span>)
    Q3 = df[coluna].quantile(<span class="syntax-number">0.75</span>)
    IQR = Q3 - Q1
    limite_inferior = Q1 - <span class="syntax-number">1.5</span> * IQR
    limite_superior = Q3 + <span class="syntax-number">1.5</span> * IQR
    <span class="syntax-keyword">return</span> (df[coluna] < limite_inferior) | (df[coluna] > limite_superior)

<span class="syntax-comment"># Método 3: Isolation Forest (Machine Learning)</span>
<span class="syntax-keyword">from</span> sklearn.ensemble <span class="syntax-keyword">import</span> IsolationForest

<span class="syntax-keyword">def</span> <span class="syntax-function">detectar_anomalias_ml</span>(df, colunas):
    modelo = IsolationForest(contamination=<span class="syntax-number">0.05</span>, random_state=<span class="syntax-number">42</span>)
    predicoes = modelo.fit_predict(df[colunas])
    <span class="syntax-keyword">return</span> predicoes == -<span class="syntax-number">1</span>

<span class="syntax-comment"># Aplicar métodos</span>
df_producao[<span class="syntax-string">'anomalia_zscore'</span>] = detectar_anomalias_zscore(df_producao, <span class="syntax-string">'producao_unidades'</span>)
df_producao[<span class="syntax-string">'anomalia_iqr'</span>] = detectar_anomalias_iqr(df_producao, <span class="syntax-string">'producao_unidades'</span>)
df_producao[<span class="syntax-string">'anomalia_ml'</span>] = detectar_anomalias_ml(
    df_producao, 
    [<span class="syntax-string">'producao_unidades'</span>, <span class="syntax-string">'oee'</span>, <span class="syntax-string">'refugo_pct'</span>]
)

<span class="syntax-comment"># Visualizar anomalias</span>
fig, ax = plt.subplots(figsize=(<span class="syntax-number">16</span>, <span class="syntax-number">6</span>))
ax.plot(df_producao[<span class="syntax-string">'data'</span>], df_producao[<span class="syntax-string">'producao_unidades'</span>], 
        label=<span class="syntax-string">'Produção Normal'</span>, alpha=<span class="syntax-number">0.7</span>)

<span class="syntax-comment"># Marcar anomalias</span>
anomalias_ml = df_producao[df_producao[<span class="syntax-string">'anomalia_ml'</span>]]
ax.scatter(anomalias_ml[<span class="syntax-string">'data'</span>], anomalias_ml[<span class="syntax-string">'producao_unidades'</span>],
          color=<span class="syntax-string">'red'</span>, s=<span class="syntax-number">100</span>, label=<span class="syntax-string">'Anomalias Detectadas'</span>, zorder=<span class="syntax-number">5</span>)

ax.set_title(<span class="syntax-string">'Detecção de Anomalias na Produção'</span>, fontsize=<span class="syntax-number">14</span>, fontweight=<span class="syntax-string">'bold'</span>)
ax.set_xlabel(<span class="syntax-string">'Data'</span>)
ax.set_ylabel(<span class="syntax-string">'Unidades Produzidas'</span>)
ax.legend()
plt.tight_layout()
plt.show()

<span class="syntax-function">print</span>(<span class="syntax-string">f"\nAnomalias detectadas:"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"  Z-Score: {df_producao['anomalia_zscore'].sum()} dias"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"  IQR: {df_producao['anomalia_iqr'].sum()} dias"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"  Isolation Forest: {df_producao['anomalia_ml'].sum()} dias"</span>)</code></pre>
            </div>
        </div>

        <div class="section">
            <h2><span class="step-indicator">7</span>Dashboard Interativo com Plotly</h2>
            <p>Criar visualizações interativas modernas para apresentação de resultados.</p>

            <div class="code-block">
                <div class="code-header">
                    <span>Dashboard Executivo Interativo</span>
                </div>
<pre><code><span class="syntax-keyword">from</span> plotly.subplots <span class="syntax-keyword">import</span> make_subplots

<span class="syntax-comment"># Criar dashboard com múltiplos gráficos</span>
fig = make_subplots(
    rows=<span class="syntax-number">2</span>, cols=<span class="syntax-number">2</span>,
    subplot_titles=(<span class="syntax-string">'Produção ao Longo do Tempo'</span>, <span class="syntax-string">'OEE por Mês'</span>,
                    <span class="syntax-string">'Distribuição de Refugo'</span>, <span class="syntax-string">'Setup vs Produção'</span>),
    specs=[[{<span class="syntax-string">'type'</span>: <span class="syntax-string">'scatter'</span>}, {<span class="syntax-string">'type'</span>: <span class="syntax-string">'bar'</span>}],
           [{<span class="syntax-string">'type'</span>: <span class="syntax-string">'histogram'</span>}, {<span class="syntax-string">'type'</span>: <span class="syntax-string">'scatter'</span>}]]
)

<span class="syntax-comment"># Gráfico 1: Produção temporal</span>
fig.add_trace(
    go.Scatter(x=df_producao[<span class="syntax-string">'data'</span>], y=df_producao[<span class="syntax-string">'producao_unidades'</span>],
               mode=<span class="syntax-string">'lines'</span>, name=<span class="syntax-string">'Produção'</span>, line=<span class="syntax-keyword">dict</span>(color=<span class="syntax-string">'blue'</span>, width=<span class="syntax-number">2</span>)),
    row=<span class="syntax-number">1</span>, col=<span class="syntax-number">1</span>
)
fig.add_hline(y=<span class="syntax-number">900</span>, line_dash=<span class="syntax-string">"dash"</span>, line_color=<span class="syntax-string">"red"</span>, 
              annotation_text=<span class="syntax-string">"Meta"</span>, row=<span class="syntax-number">1</span>, col=<span class="syntax-number">1</span>)

<span class="syntax-comment"># Gráfico 2: OEE mensal</span>
oee_mensal = df_producao.groupby(<span class="syntax-string">'mes'</span>)[<span class="syntax-string">'oee'</span>].mean()
fig.add_trace(
    go.Bar(x=oee_mensal.index, y=oee_mensal.values, name=<span class="syntax-string">'OEE Médio'</span>,
           marker_color=<span class="syntax-string">'lightgreen'</span>),
    row=<span class="syntax-number">1</span>, col=<span class="syntax-number">2</span>
)

<span class="syntax-comment"># Gráfico 3: Distribuição de refugo</span>
fig.add_trace(
    go.Histogram(x=df_producao[<span class="syntax-string">'refugo_pct'</span>], name=<span class="syntax-string">'Refugo'</span>,
                 marker_color=<span class="syntax-string">'orange'</span>, nbinsx=<span class="syntax-number">30</span>),
    row=<span class="syntax-number">2</span>, col=<span class="syntax-number">1</span>
)

<span class="syntax-comment"># Gráfico 4: Correlação setup vs produção</span>
fig.add_trace(
    go.Scatter(x=df_producao[<span class="syntax-string">'tempo_setup_min'</span>], 
               y=df_producao[<span class="syntax-string">'producao_unidades'</span>],
               mode=<span class="syntax-string">'markers'</span>, name=<span class="syntax-string">'Dados'</span>,
               marker=<span class="syntax-keyword">dict</span>(size=<span class="syntax-number">8</span>, color=df_producao[<span class="syntax-string">'oee'</span>],
                          colorscale=<span class="syntax-string">'Viridis'</span>, showscale=<span class="syntax-number">True</span>,
                          colorbar=<span class="syntax-keyword">dict</span>(title=<span class="syntax-string">"OEE"</span>, x=<span class="syntax-number">1.15</span>))),
    row=<span class="syntax-number">2</span>, col=<span class="syntax-number">2</span>
)

<span class="syntax-comment"># Layout</span>
fig.update_layout(
    height=<span class="syntax-number">800</span>,
    showlegend=<span class="syntax-number">False</span>,
    title_text=<span class="syntax-string">"Dashboard de Produção Industrial"</span>,
    title_font_size=<span class="syntax-number">20</span>
)

fig.show()

<span class="syntax-comment"># Métricas principais</span>
<span class="syntax-function">print</span>(<span class="syntax-string">"\n=== MÉTRICAS PRINCIPAIS ==="</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"Produção Média: {df_producao['producao_unidades'].mean():.0f} unidades/dia"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"OEE Médio: {df_producao['oee'].mean():.1f}%"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"Taxa de Refugo: {df_producao['refugo_pct'].mean():.2f}%"</span>)
<span class="syntax-function">print</span>(<span class="syntax-string">f"Dias Acima da Meta: {(df_producao['producao_unidades'] > 900).sum()} ({(df_producao['producao_unidades'] > 900).mean()*100:.1f}%)"</span>)</code></pre>
            </div>
        </div>

        <div class="section">
            <h2><span class="step-indicator">8</span>Projeto Integrado: Sistema Completo</h2>
            
            <div class="exercise-box">
                <h4>Projeto Final da Aula</h4>
                <p>Desenvolva um sistema completo que integre todos os conceitos vistos:</p>
                
                <p><strong>Requisitos:</strong></p>
                <ol style="margin-left: 20px; line-height: 1.8;">
                    <li>Carregue ou gere dados de produção (mínimo 3 meses)</li>
                    <li>Realize análise exploratória completa com estatísticas</li>
                    <li>Crie visualizações profissionais (mínimo 4 gráficos diferentes)</li>
                    <li>Implemente um modelo de otimização OU previsão</li>
                    <li>Detecte anomalias nos dados</li>
                    <li>Gere um dashboard interativo final</li>
                    <li>Documente insights e recomendações</li>
                </ol>
            </div>

            <div class="checkpoint-box">
                <h3>Checkpoint 3 - Entrega 30/09</h3>
                <p><strong>Formato:</strong> Notebook Google Colab compartilhável<br>
                <strong>Conteúdo Mínimo:</strong> Implementação de pelo menos 4 das 6 técnicas apresentadas<br>
                <strong>Dados:</strong> Podem ser reais (se disponíveis) ou simulados realistas<br>
                <strong>Documentação:</strong> Código comentado + análise dos resultados<br>
                <strong>Apresentação:</strong> 10 minutos + 5 minutos de perguntas</p>
            </div>

            <div class="success-box">
                <h4>Critérios de Avaliação</h4>
                <p><strong>Código (30%):</strong> Funcionalidade, organização e boas práticas<br>
                <strong>Análise (30%):</strong> Qualidade dos insights e interpretações<br>
                <strong>Visualização (20%):</strong> Clareza e profissionalismo dos gráficos<br>
                <strong>Documentação (20%):</strong> Explicações claras e reprodutibilidade</p>
            </div>
        </div>

        <div class="section">
            <h2><span class="step-indicator">9</span>Recursos e Próximos Passos</h2>
            
            <div class="tool-info">
                <h4>Bibliotecas Adicionais para Explorar</h4>
                <p><strong>Streamlit:</strong> Criar web apps de dados rapidamente<br>
                <strong>Dash (Plotly):</strong> Dashboards interativos profissionais<br>
                <strong>XGBoost/LightGBM:</strong> Machine Learning avançado<br>
                <strong>Optuna:</strong> Otimização de hiperparâmetros<br>
                <strong>PyTorch/TensorFlow:</strong> Deep Learning<br>
                <strong>FastAPI:</strong> Criar APIs para modelos de ML</p>
            </div>

            <div class="warning-box">
                <h4>Boas Práticas de Código</h4>
                <p>Sempre documente seu código com comentários claros. Use nomes de variáveis descritivos. Organize o código em funções reutilizáveis. Valide seus dados antes de processar. Trate exceções e erros adequadamente. Versione seu código (Git/GitHub).</p>
            </div>

            <div class="highlight-box">
                <h3>Resumo da Aula</h3>
                <p>Nesta aula implementamos soluções práticas em Python para problemas reais da engenharia de produção. Trabalhamos com análise de dados, otimização, previsão e detecção de anomalias usando bibliotecas modernas e atuais. O domínio dessas ferramentas permite automatizar análises complexas e tomar decisões baseadas em dados.</p>
            </div>
        </div>
    </div>
</body>
</html>
